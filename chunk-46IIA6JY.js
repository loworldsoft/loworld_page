import{b as he}from"./chunk-YBG5YJGR.js";import{a as de,b as ue}from"./chunk-NCFTNANG.js";import{c as me}from"./chunk-W6GIRAK2.js";import{a as ge,b as pe}from"./chunk-R2H4B67A.js";import{k as se,m as re,n as A,o as le}from"./chunk-CUTTAL6N.js";import{ga as ce}from"./chunk-J3RFNY3B.js";import{$ as S,A as X,E as Z,F as ee,G as te,H as ne,I as oe,W as ie,X as ae,Z as E,ba as O,d as R,e as T,m as U,u as J}from"./chunk-F7C2LCNM.js";import{Mb as m,Nb as i,Ob as a,Pb as x,Tb as b,W as P,Xa as H,Xb as f,Yb as l,ac as j,ba as V,bb as r,bc as $,ca as w,cc as Q,d as C,fa as z,gb as _,ic as G,j as y,la as u,lc as s,ma as h,mc as M,nb as I,nc as v,ob as k,rc as K,s as L,sb as d,sc as W,tc as Y}from"./chunk-GLJNWZ2D.js";var D=class o{constructor(e){this.http=e;this.loadChatbotConfig()}chatbotConfig=null;keywordResponseMap=new Map;noMatchCount=0;failureCount=0;loadChatbotConfig(){return C(this,null,function*(){try{this.chatbotConfig=yield L(this.http.get("/assets/json/chat-talk-config.json")),this.buildKeywordMap(),console.log("\u2705 \uCC57\uBD07 \uC124\uC815 \uB85C\uB4DC \uC644\uB8CC")}catch(e){console.error("\u274C \uCC57\uBD07 \uC124\uC815 \uB85C\uB4DC \uC2E4\uD328:",e),this.setDefaultConfig()}})}setDefaultConfig(){this.chatbotConfig={chatbot:{name:"\uC2A4\uD1A0\uC5B4 \uCC57\uBD07",description:"Store \uC804\uC6A9 \uACE0\uAC1D \uC0C1\uB2F4 \uCC57\uBD07",welcomeMessage:"\uC548\uB155\uD558\uC138\uC694! \uBB34\uC5C7\uC744 \uB3C4\uC640\uB4DC\uB9B4\uAE4C\uC694?",defaultResponses:{notFound:'\uC8C4\uC1A1\uD569\uB2C8\uB2E4. \uC815\uD655\uD55C \uB2F5\uBCC0\uC744 \uCC3E\uAE30 \uC5B4\uB824\uC6CC\uC694. \uC0C1\uB2F4\uC6D0 \uC5F0\uACB0\uC744 \uC6D0\uD558\uC2DC\uBA74 "\uC0C1\uB2F4\uC6D0"\uC774\uB77C\uACE0 \uB9D0\uC500\uD574 \uC8FC\uC138\uC694.',error:"\uC77C\uC2DC\uC801\uC778 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4. \uC7A0\uC2DC \uD6C4 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.",transferToAgent:"\uC0C1\uB2F4\uC6D0\uC5D0\uAC8C \uC5F0\uACB0\uD574\uB4DC\uB9AC\uACA0\uC2B5\uB2C8\uB2E4. \uC7A0\uC2DC\uB9CC \uAE30\uB2E4\uB824\uC8FC\uC138\uC694."}},quickReplies:["\uC0C1\uD488 \uBB38\uC758","\uC8FC\uBB38 \uC870\uD68C","\uBC30\uC1A1 \uBB38\uC758","\uC0C1\uB2F4\uC6D0 \uC5F0\uACB0"],responses:{greeting:{keywords:["\uC548\uB155","\uC548\uB155\uD558\uC138\uC694","\uCC98\uC74C"],message:"\uC548\uB155\uD558\uC138\uC694! \uBB34\uC5C7\uC744 \uB3C4\uC640\uB4DC\uB9B4\uAE4C\uC694?"},human_agent:{keywords:["\uC0C1\uB2F4\uC6D0","\uC0C1\uB2F4\uC0AC","\uC0AC\uB78C","\uC9C1\uC6D0","\uC5F0\uACB0"],message:"\uC0C1\uB2F4\uC6D0\uC5D0\uAC8C \uC5F0\uACB0\uD574\uB4DC\uB9AC\uACA0\uC2B5\uB2C8\uB2E4.",action:"connectAgent"}},chatFlow:{triggers:{keywords:["\uC0C1\uB2F4\uC6D0","\uC0C1\uB2F4\uC0AC","\uC0AC\uB78C"],failureCount:3,noMatchCount:2},humanHandoff:{message:"\uC0C1\uB2F4\uC6D0\uC5D0\uAC8C \uC5F0\uACB0\uD574\uB4DC\uB9AC\uACA0\uC2B5\uB2C8\uB2E4.",action:"connectAgent",endpoint:"/api/chat-talk/transfer-to-human"}}},this.buildKeywordMap()}buildKeywordMap(){this.chatbotConfig?.responses&&(Object.entries(this.chatbotConfig.responses).forEach(([e,t])=>{let n={message:t.message,action:t.action||null,quickReplies:this.chatbotConfig?.quickReplies||[]};t.keywords?.forEach(c=>{this.keywordResponseMap.set(c.toLowerCase(),n)})}),console.log(`\u{1F5FA}\uFE0F \uD0A4\uC6CC\uB4DC \uB9F5 \uC0DD\uC131 \uC644\uB8CC: ${this.keywordResponseMap.size}\uAC1C`))}processMessage(e){return C(this,null,function*(){this.chatbotConfig||(yield this.loadChatbotConfig());let t=this.normalizeMessage(e),n=this.findExactKeywordMatch(t);return n||(n=this.findPartialMatch(t)),n?(this.resetCounters(),n):this.handleNoMatch()})}normalizeMessage(e){return e.toLowerCase().trim().replace(/[^\w\sㄱ-ㅎㅏ-ㅣ가-힣]/g,"").replace(/\s+/g," ")}findExactKeywordMatch(e){return this.keywordResponseMap.get(e)||null}findPartialMatch(e){for(let[t,n]of this.keywordResponseMap.entries())if(e.includes(t)||t.includes(e))return n;return null}handleNoMatch(){this.noMatchCount++,this.failureCount++;let e=this.chatbotConfig,t=e.chatFlow.triggers;return this.failureCount>=t.failureCount||this.noMatchCount>=t.noMatchCount?(this.resetCounters(),{message:e.chatFlow.humanHandoff.message,action:e.chatFlow.humanHandoff.action,quickReplies:[]}):{message:e.chatbot.defaultResponses.notFound,quickReplies:e.quickReplies}}resetCounters(){this.noMatchCount=0,this.failureCount=0}getWelcomeMessage(){return this.chatbotConfig?.chatbot.welcomeMessage||"\uC548\uB155\uD558\uC138\uC694!"}getQuickReplies(){return this.chatbotConfig?.quickReplies||[]}static \u0275fac=function(t){return new(t||o)(z(J))};static \u0275prov=V({token:o,factory:o.\u0275fac,providedIn:"root"})};var ve=["chatMessages"];function Oe(o,e){o&1&&(i(0,"div",24)(1,"mat-icon"),s(2,"smart_toy"),a()())}function ye(o,e){if(o&1&&(i(0,"div",19),d(1,Oe,3,0,"div",20),i(2,"div",21),x(3,"div",22),i(4,"div",23),s(5),a()()()),o&2){let t=l().$implicit,n=l();r(),m("ngIf",t.senderType==="bot"),r(2),m("innerHTML",t.content,H),r(2),M(n.formatTime(t.createdAt))}}function Pe(o,e){if(o&1&&(i(0,"div",19)(1,"div",21)(2,"div",25),s(3),a(),i(4,"div",23),s(5),a()()()),o&2){let t=l().$implicit,n=l();r(3),M(t.content),r(2),M(n.formatTime(t.createdAt))}}function we(o,e){if(o&1&&(i(0,"div",17),d(1,ye,6,3,"div",18)(2,Pe,6,2,"div",18),a()),o&2){let t=e.$implicit;G("user-message",t.senderType==="client")("bot-message",t.senderType==="bot")("system-message",t.senderType==="system"),r(),m("ngIf",t.senderType!=="client"),r(),m("ngIf",t.senderType==="client")}}function Ie(o,e){o&1&&(i(0,"div",26)(1,"div",27),x(2,"span")(3,"span")(4,"span"),a()())}function ke(o,e){if(o&1){let t=b();i(0,"button",30),f("click",function(){let c=u(t).$implicit,g=l(2);return h(g.selectQuickReply(c))}),s(1),a()}if(o&2){let t=e.$implicit;r(),v(" ",t," ")}}function Re(o,e){if(o&1&&(i(0,"div",28),d(1,ke,2,1,"button",29),a()),o&2){let t=l();r(),m("ngForOf",t.quickReplies)}}var N=class o{constructor(e,t,n){this.route=e;this.router=t;this.chatBotService=n}chatContainer;storeId="";roomId=null;isNewChat=!1;messages=[];newMessage="";welcomeMessage="";showQuickReplies=!0;quickReplies=[];isLoading=!1;currentTime=new Date;destroy$=new y;ngOnInit(){this.route.queryParams.pipe(P(this.destroy$)).subscribe(e=>{this.storeId=e.storeId||"",this.roomId=e.roomId||null,this.isNewChat=e.isNew==="true",this.isNewChat?this.initNewChat():this.roomId&&this.loadExistingChat()}),this.quickReplies=this.chatBotService.getQuickReplies()}ngAfterViewChecked(){this.scrollToBottom()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initNewChat(){return C(this,null,function*(){this.welcomeMessage=this.chatBotService.getWelcomeMessage(),this.currentTime=new Date,this.showQuickReplies=!0;let e={id:"welcome",roomId:"",senderType:"bot",content:this.welcomeMessage,createdAt:new Date};this.messages=[e]})}loadExistingChat(){this.isLoading=!0,this.isLoading=!1}sendMessage(e){return C(this,null,function*(){e&&e.preventDefault();let t=this.newMessage.trim();if(!t)return;let n={id:`temp-${Date.now()}`,roomId:this.roomId||"",senderType:"client",content:t,createdAt:new Date,status:"sent"};this.messages.push(n),this.newMessage="",this.showQuickReplies&&(yield this.processBotResponse(t))})}processBotResponse(e){return C(this,null,function*(){setTimeout(()=>C(this,null,function*(){let t=yield this.chatBotService.processMessage(e),n={id:`bot-${Date.now()}`,roomId:this.roomId||"",senderType:"bot",content:t.message,createdAt:new Date};this.messages.push(n),t.action==="connectAgent"&&this.connectToAgent(),t.quickReplies&&(this.quickReplies=t.quickReplies)}),1e3)})}selectQuickReply(e){this.newMessage=e,this.sendMessage()}connectToAgent(){console.log("\uC0C1\uB2F4\uC6D0 \uC5F0\uACB0 \uC694\uCCAD"),this.showQuickReplies=!1;let e={id:`system-${Date.now()}`,roomId:this.roomId||"",senderType:"system",content:"\uC0C1\uB2F4\uC6D0 \uC5F0\uACB0\uC744 \uC694\uCCAD\uD588\uC2B5\uB2C8\uB2E4. \uC7A0\uC2DC\uB9CC \uAE30\uB2E4\uB824\uC8FC\uC138\uC694.",createdAt:new Date};this.messages.push(e)}goBack(){this.router.navigate(["/chat-talk/client/home"],{queryParams:{storeId:this.storeId}})}onInputChange(){let e=document.querySelector("textarea");e&&this.autoResizeTextarea(e)}onEnterPress(e){e.shiftKey||(e.preventDefault(),this.sendMessage())}autoResizeTextarea(e){e.style.height="auto",e.style.height=Math.min(e.scrollHeight,120)+"px"}scrollToBottom(){try{this.chatContainer&&(this.chatContainer.nativeElement.scrollTop=this.chatContainer.nativeElement.scrollHeight)}catch(e){console.error("Scroll error:",e)}}formatTime(e){return new Date(e).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})}static \u0275fac=function(t){return new(t||o)(_(E),_(S),_(D))};static \u0275cmp=I({type:o,selectors:[["app-chat-client"]],viewQuery:function(t,n){if(t&1&&j(ve,5),t&2){let c;$(c=Q())&&(n.chatContainer=c.first)}},standalone:!1,decls:28,vars:6,consts:[["chatMessages",""],[1,"chat-container"],[1,"chat-header"],[1,"back-btn",3,"click"],[1,"header-info"],[1,"status-text"],[1,"menu-btn"],[1,"messages-container"],[1,"messages-list"],["class","message-wrapper",3,"user-message","bot-message","system-message",4,"ngFor","ngForOf"],["class","loading-message",4,"ngIf"],["class","quick-replies",4,"ngIf"],[1,"input-container"],[1,"input-form",3,"submit"],["type","button","matTooltip","\uD30C\uC77C \uCCA8\uBD80",1,"attach-btn"],["name","message","placeholder","\uBA54\uC2DC\uC9C0\uB97C \uC785\uB825\uD558\uC138\uC694...","rows","1",1,"message-input",3,"ngModelChange","input","keydown.enter","ngModel"],["type","submit","matTooltip","\uC804\uC1A1",1,"send-btn",3,"disabled"],[1,"message-wrapper"],["class","message-bubble",4,"ngIf"],[1,"message-bubble"],["class","message-avatar",4,"ngIf"],[1,"message-content"],[1,"message-text",3,"innerHTML"],[1,"message-time"],[1,"message-avatar"],[1,"message-text"],[1,"loading-message"],[1,"typing-indicator"],[1,"quick-replies"],["class","quick-reply-btn",3,"click",4,"ngFor","ngForOf"],[1,"quick-reply-btn",3,"click"]],template:function(t,n){if(t&1){let c=b();i(0,"div",1)(1,"div",2)(2,"button",3),f("click",function(){return u(c),h(n.goBack())}),i(3,"mat-icon"),s(4,"arrow_back"),a()(),i(5,"div",4)(6,"h2"),s(7,"\uACE0\uAC1D \uC0C1\uB2F4"),a(),i(8,"p",5),s(9),a()(),i(10,"button",6)(11,"mat-icon"),s(12,"more_vert"),a()()(),i(13,"div",7,0)(15,"div",8),d(16,we,3,8,"div",9)(17,Ie,5,0,"div",10),a()(),d(18,Re,2,1,"div",11),i(19,"div",12)(20,"form",13),f("submit",function(p){return u(c),h(n.sendMessage(p))}),i(21,"button",14)(22,"mat-icon"),s(23,"attach_file"),a()(),i(24,"textarea",15),Y("ngModelChange",function(p){return u(c),W(n.newMessage,p)||(n.newMessage=p),h(p)}),f("input",function(){return u(c),h(n.onInputChange())})("keydown.enter",function(p){return u(c),h(n.onEnterPress(p))}),a(),i(25,"button",16)(26,"mat-icon"),s(27,"send"),a()()()()()}t&2&&(r(9),v(" ",n.showQuickReplies?"\uCC57\uBD07 \uC751\uB2F5":"\uC0C1\uB2F4\uC6D0 \uC5F0\uACB0\uB428"," "),r(7),m("ngForOf",n.messages),r(),m("ngIf",n.isLoading),r(),m("ngIf",n.showQuickReplies&&n.quickReplies.length>0),r(6),K("ngModel",n.newMessage),r(),m("disabled",!n.newMessage.trim()))},dependencies:[R,T,oe,X,Z,ee,ne,te,A,de],styles:[".chat-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;background:#f5f5f5}.chat-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px 16px;background:#fff;border-bottom:1px solid #e0e0e0;box-shadow:0 2px 4px #0000000d}.chat-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%], .chat-header[_ngcontent-%COMP%]   .menu-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;border-radius:50%;transition:background .2s}.chat-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover, .chat-header[_ngcontent-%COMP%]   .menu-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5}.chat-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .chat-header[_ngcontent-%COMP%]   .menu-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#333}.chat-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]{flex:1;margin:0 12px}.chat-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600;color:#333}.chat-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{margin:2px 0 0;font-size:12px;color:#667eea}.messages-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px}.messages-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.message-wrapper[_ngcontent-%COMP%]{display:flex}.message-wrapper.user-message[_ngcontent-%COMP%]{justify-content:flex-end}.message-wrapper.user-message[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]{flex-direction:row-reverse}.message-wrapper.user-message[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{background:#667eea;color:#fff}.message-wrapper.user-message[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]   .message-time[_ngcontent-%COMP%]{color:#fffc}.message-wrapper.bot-message[_ngcontent-%COMP%], .message-wrapper.system-message[_ngcontent-%COMP%]{justify-content:flex-start}.message-wrapper.system-message[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2;font-size:14px;text-align:center}.message-bubble[_ngcontent-%COMP%]{display:flex;gap:8px;max-width:70%}.message-bubble[_ngcontent-%COMP%]   .message-avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background:#667eea;display:flex;align-items:center;justify-content:center;flex-shrink:0}.message-bubble[_ngcontent-%COMP%]   .message-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff;font-size:20px;width:20px;height:20px}.message-bubble[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:12px 16px;box-shadow:0 1px 2px #0000001a}.message-bubble[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]{font-size:14px;line-height:1.5;white-space:pre-wrap;word-break:break-word}.message-bubble[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]   .message-time[_ngcontent-%COMP%]{font-size:11px;color:#999;margin-top:4px}.loading-message[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.typing-indicator[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:12px 16px;display:flex;gap:4px}.typing-indicator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:8px;height:8px;background:#999;border-radius:50%;animation:_ngcontent-%COMP%_typing 1.4s infinite}.typing-indicator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.typing-indicator[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){animation-delay:.4s}@keyframes _ngcontent-%COMP%_typing{0%,60%,to{transform:translateY(0);opacity:.7}30%{transform:translateY(-10px);opacity:1}}.quick-replies[_ngcontent-%COMP%]{padding:8px 16px;background:#fff;border-top:1px solid #e0e0e0;display:flex;gap:8px;overflow-x:auto;flex-wrap:wrap}.quick-replies[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.quick-replies[_ngcontent-%COMP%]   .quick-reply-btn[_ngcontent-%COMP%]{padding:8px 16px;background:#fff;border:1px solid #667eea;color:#667eea;border-radius:20px;font-size:13px;cursor:pointer;white-space:nowrap;transition:all .2s}.quick-replies[_ngcontent-%COMP%]   .quick-reply-btn[_ngcontent-%COMP%]:hover{background:#667eea;color:#fff}.input-container[_ngcontent-%COMP%]{background:#fff;border-top:1px solid #e0e0e0;padding:12px 16px}.input-form[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:8px}.input-form[_ngcontent-%COMP%]   .attach-btn[_ngcontent-%COMP%], .input-form[_ngcontent-%COMP%]   .send-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;border-radius:50%;transition:background .2s;flex-shrink:0}.input-form[_ngcontent-%COMP%]   .attach-btn[_ngcontent-%COMP%]:hover:not(:disabled), .input-form[_ngcontent-%COMP%]   .send-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#f5f5f5}.input-form[_ngcontent-%COMP%]   .attach-btn[_ngcontent-%COMP%]:disabled, .input-form[_ngcontent-%COMP%]   .send-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.input-form[_ngcontent-%COMP%]   .attach-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .input-form[_ngcontent-%COMP%]   .send-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#667eea}.input-form[_ngcontent-%COMP%]   .message-input[_ngcontent-%COMP%]{flex:1;border:1px solid #e0e0e0;border-radius:20px;padding:10px 16px;font-size:14px;font-family:inherit;resize:none;max-height:120px;outline:none}.input-form[_ngcontent-%COMP%]   .message-input[_ngcontent-%COMP%]:focus{border-color:#667eea}.input-form[_ngcontent-%COMP%]   .message-input[_ngcontent-%COMP%]::placeholder{color:#999}.input-form[_ngcontent-%COMP%]   .send-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{transform:rotate(-45deg)}"]})};function Te(o,e){if(o&1&&(i(0,"span",17),s(1),a()),o&2){let t=l().$implicit;r(),v(" ",t.unreadCount," ")}}function Ee(o,e){if(o&1){let t=b();i(0,"div",10),f("click",function(){let c=u(t).$implicit,g=l(2);return h(g.openChatRoom(c))}),i(1,"div",11)(2,"mat-icon"),s(3,"chat_bubble"),a(),d(4,Te,2,1,"span",12),a(),i(5,"div",13)(6,"div",14),s(7),a(),i(8,"div",15),s(9),a()(),i(10,"mat-icon",16),s(11,"chevron_right"),a()()}if(o&2){let t=e.$implicit,n=l(2);r(4),m("ngIf",t.unreadCount&&t.unreadCount>0),r(3),M(n.getRoomStatusText(t.status)),r(2),M(n.formatTime(t.lastMessageAt))}}function Se(o,e){if(o&1&&(i(0,"div",7)(1,"h2"),s(2,"\uC774\uC804 \uB300\uD654"),a(),i(3,"div",8),d(4,Ee,12,3,"div",9),a()()),o&2){let t=l();r(4),m("ngForOf",t.chatRooms)}}function Ae(o,e){o&1&&(i(0,"div",18),x(1,"mat-spinner",19),a())}function De(o,e){o&1&&(i(0,"div",20)(1,"mat-icon"),s(2,"chat_bubble_outline"),a(),i(3,"p"),s(4,"\uC544\uC9C1 \uB300\uD654 \uB0B4\uC5ED\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"),a(),i(5,"p",21),s(6,"\uC0C8 \uBB38\uC758\uB97C \uC2DC\uC791\uD574\uBCF4\uC138\uC694!"),a()())}var F=class o{constructor(e,t){this.router=e;this.route=t}storeId="";chatRooms=[];isLoading=!1;destroy$=new y;ngOnInit(){this.route.queryParams.pipe(P(this.destroy$)).subscribe(e=>{this.storeId=e.storeId||"",this.storeId&&this.loadChatRooms()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadChatRooms(){this.isLoading=!0,this.chatRooms=[],this.isLoading=!1}startNewChat(){this.router.navigate(["/chat-talk/client/chat"],{queryParams:{storeId:this.storeId,isNew:!0}})}openChatRoom(e){this.router.navigate(["/chat-talk/client/chat"],{queryParams:{storeId:this.storeId,roomId:e.id}})}getRoomStatusText(e){return{bot_active:"\uCC57\uBD07 \uC751\uB2F5",waiting_agent:"\uC0C1\uB2F4\uC6D0 \uB300\uAE30\uC911",agent_active:"\uC0C1\uB2F4 \uC9C4\uD589\uC911",resolved:"\uC644\uB8CC",closed:"\uC885\uB8CC"}[e]||e}formatTime(e){if(!e)return"";let n=new Date().getTime()-new Date(e).getTime(),c=Math.floor(n/(1e3*60)),g=Math.floor(n/(1e3*60*60)),p=Math.floor(n/(1e3*60*60*24));return c<1?"\uBC29\uAE08 \uC804":c<60?`${c}\uBD84 \uC804`:g<24?`${g}\uC2DC\uAC04 \uC804`:p<7?`${p}\uC77C \uC804`:new Date(e).toLocaleDateString()}static \u0275fac=function(t){return new(t||o)(_(S),_(E))};static \u0275cmp=I({type:o,selectors:[["app-chat-client-home"]],standalone:!1,decls:17,vars:3,consts:[[1,"chat-home-container"],[1,"home-header"],[1,"home-content"],[1,"new-chat-btn",3,"click"],["class","chat-history",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"chat-history"],[1,"room-list"],["class","room-item",3,"click",4,"ngFor","ngForOf"],[1,"room-item",3,"click"],[1,"room-icon"],["class","unread-badge",4,"ngIf"],[1,"room-info"],[1,"room-status"],[1,"room-time"],[1,"arrow-icon"],[1,"unread-badge"],[1,"loading-container"],["diameter","40"],[1,"empty-state"],[1,"empty-sub"]],template:function(t,n){t&1&&(i(0,"div",0)(1,"div",1)(2,"h1")(3,"mat-icon"),s(4,"chat"),a(),s(5," \uACE0\uAC1D \uC0C1\uB2F4 "),a(),i(6,"p"),s(7,"\uBB34\uC5C7\uC744 \uB3C4\uC640\uB4DC\uB9B4\uAE4C\uC694?"),a()(),i(8,"div",2)(9,"button",3),f("click",function(){return n.startNewChat()}),i(10,"mat-icon"),s(11,"add_comment"),a(),i(12,"span"),s(13,"\uC0C8 \uBB38\uC758\uD558\uAE30"),a()(),d(14,Se,5,1,"div",4)(15,Ae,2,0,"div",5)(16,De,7,0,"div",6),a()()),t&2&&(r(14),m("ngIf",n.chatRooms.length>0),r(),m("ngIf",n.isLoading),r(),m("ngIf",!n.isLoading&&n.chatRooms.length===0))},dependencies:[R,T,A,ge],styles:[".chat-home-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;padding:20px;height:100vh;display:flex;flex-direction:column}.home-header[_ngcontent-%COMP%]{text-align:center;padding:20px 0}.home-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:10px;font-size:24px;font-weight:600;margin:0 0 10px}.home-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px}.home-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin:0}.home-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.new-chat-btn[_ngcontent-%COMP%]{width:100%;padding:20px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:30px;transition:transform .2s,box-shadow .2s}.new-chat-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.new-chat-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 16px #0003}.new-chat-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.chat-history[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin:0 0 15px;color:#333}.room-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.room-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:15px;background:#fff;border:1px solid #e0e0e0;border-radius:8px;cursor:pointer;transition:all .2s}.room-item[_ngcontent-%COMP%]:hover{background:#f5f5f5;border-color:#667eea}.room-item[_ngcontent-%COMP%]   .room-icon[_ngcontent-%COMP%]{position:relative;margin-right:15px}.room-item[_ngcontent-%COMP%]   .room-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px;color:#667eea}.room-item[_ngcontent-%COMP%]   .room-icon[_ngcontent-%COMP%]   .unread-badge[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;background:#f44;color:#fff;border-radius:10px;padding:2px 6px;font-size:11px;font-weight:600;min-width:18px;text-align:center}.room-item[_ngcontent-%COMP%]   .room-info[_ngcontent-%COMP%]{flex:1}.room-item[_ngcontent-%COMP%]   .room-info[_ngcontent-%COMP%]   .room-status[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333;margin-bottom:4px}.room-item[_ngcontent-%COMP%]   .room-info[_ngcontent-%COMP%]   .room-time[_ngcontent-%COMP%]{font-size:12px;color:#999}.room-item[_ngcontent-%COMP%]   .arrow-icon[_ngcontent-%COMP%]{color:#ccc}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:40px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#999}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:20px;opacity:.3}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:10px 0;font-size:16px}.empty-state[_ngcontent-%COMP%]   .empty-sub[_ngcontent-%COMP%]{font-size:14px;color:#bbb}"]})};var Be=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:F},{path:"chat",component:N}],q=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=k({type:o});static \u0275inj=w({imports:[O.forChild(Be),O]})};var Ce=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=k({type:o});static \u0275inj=w({imports:[U,O,q,ie,ae,ce,le,se,re,ue,pe,me,he]})};export{Ce as ChatTalkClientModule};
