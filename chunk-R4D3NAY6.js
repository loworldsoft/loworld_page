import{a as M}from"./chunk-HQSEMCCA.js";import{a as wt,b as Dt,c as Pt,d as Ot,e as b,f as G,g as St,h as Ft,j as jt,k as Vt,l as It,m as At,n as Tt}from"./chunk-ORS73STK.js";import{H as _t,a as D}from"./chunk-RUVVEFL4.js";import{Aa as yt,Ea as Ct,Ja as W,Ka as Mt,L as pt,Ma as vt,Na as bt,Q as mt,Y as ht,ea as ut,fa as ft,ua as gt,za as xt}from"./chunk-3HC7CDKU.js";import"./chunk-CARY4E7O.js";import{l as U,oa as dt}from"./chunk-TH5CS6OC.js";import{Aa as q,Cb as k,Da as _,Fb as E,Gb as F,Jb as x,Ka as T,Lb as y,Mb as C,Nb as l,Ob as a,Pb as v,Sb as J,Tb as K,Wb as Y,aa as S,bc as $,cc as B,dc as R,fb as s,fd as rt,ha as I,hc as d,ic as p,jc as Z,kc as tt,kd as st,lc as et,ld as lt,ma as h,mc as nt,nd as ct,qa as g,ra as A,rc as it,sb as w,tc as L,uc as ot,vc as at,xb as X,za as N}from"./chunk-6NI24FLG.js";function Qt(n,m){if(n&1&&(l(0,"div",3)(1,"mat-icon",4),d(2,"circle"),a(),l(3,"span",5),d(4),a(),l(5,"span"),d(6),a(),v(7,"span",6),l(8,"span"),d(9),L(10,"date"),a()()),n&2){let t=m.$implicit;s(),F("status-"+t.status),s(3),p(t.label),s(2),p(t.name),s(3),p(at(10,5,t.endDate,"MM-dd HH:mm"))}}var z=(()=>{class n extends D{constructor(){super(...arguments),this.dashboardVM=h(M)}ngOnInit(){console.log("\uB4E4\uC5B4\uC628 \uB370\uC774\uD130, ",this.data)}static{this.\u0275fac=(()=>{let t;return function(e){return(t||(t=_(n)))(e||n)}})()}static{this.\u0275cmp=g({type:n,selectors:[["app-today-schedule"]],features:[w],decls:8,vars:3,consts:[[1,"column-container"],[1,""],[1,"content-body"],[1,"content-item"],[1,"schedule-icon"],[1,"schedule-status"],[1,"spacer"]],template:function(i,e){i&1&&(l(0,"div",0)(1,"mat-toolbar",1)(2,"span"),d(3),a()(),l(4,"div",2),y(5,Qt,11,8,"div",3,x),L(7,"async"),a()()),i&2&&(s(3),p(e.data.title),s(2),C(ot(7,1,e.dashboardVM.todaySchedule$)))},dependencies:[W,ut,st,lt],styles:[".content-body[_ngcontent-%COMP%]{padding:10px}.content-item[_ngcontent-%COMP%]{display:flex;border-bottom:1px solid lightgray;align-items:center;padding:5px 0}.schedule-icon[_ngcontent-%COMP%]{width:16px;height:16px;font-size:16px}.schedule-status[_ngcontent-%COMP%]{margin-right:10px}.spacer[_ngcontent-%COMP%]{flex:1}.status-all[_ngcontent-%COMP%]{color:#2196f3}.status-receive[_ngcontent-%COMP%]{color:#90caf9}.status-progress[_ngcontent-%COMP%]{color:#ffb74d}.status-complete[_ngcontent-%COMP%]{color:#66bb6a}"]})}}return n})();var Nt=["chatConatiner"];function qt(n,m){if(n&1&&(l(0,"mat-option",6),d(1),a()),n&2){let t=m.$implicit;k("value",t.id),s(),p(t.name)}}function Lt(n,m){if(n&1&&(l(0,"div",10)(1,"div",11)(2,"span",12),d(3),a(),v(4,"span",13),l(5,"span"),d(6),a()(),l(7,"div",14)(8,"span",15),d(9),a()()()),n&2){let t=m.$implicit;F(t.status+"-lighten"),s(3),p(t.label),s(3),p(t.count),s(),F(t.status+"-darken"),s(2),Z("",t.ratio*100,"%")}}var kt=(()=>{class n extends D{constructor(){super(...arguments),this.projectVM=h(_t),this.dashboarVM=h(M),this.projects=[],this.project={name:"\uCD08\uAE30\uD654"},this.scheduleRatio=[{count:0,status:"all",label:this.dashboarVM.label.all,ratio:0},{count:0,status:"receive",label:this.dashboarVM.label.receive,ratio:0},{count:0,status:"progress",label:this.dashboarVM.label.progress,ratio:0},{count:0,status:"complete",label:this.dashboarVM.label.complete,ratio:0}],this.color={all:"#2196F3",receive:"#90CAF9",progress:"#FFB74D",complete:"#66BB6A"}}ngOnInit(){this.projectVM.projects$.pipe(S(this.destroy$)).subscribe(t=>{this.projects=t}),this.dashboarVM.scheduleRatio$.pipe(S(this.destroy$)).subscribe(t=>{if(!t)return;let i=t.filter(e=>e.status!=="all"&&e.count>0);this.renderChart(i),this.scheduleRatio=t})}ngAfterViewInit(){requestAnimationFrame(()=>{this.createDonutChat()})}onSelectionChange(t){console.log("\uC120\uD0DD\uB41C \uD504\uB85C\uC81D\uD2B8 id",t);let i=t.value,e=this.projects.find(r=>r.id===i);console.log("\uCC3E\uC740 \uD504\uB85C\uC81D\uD2B8, ",e),this.dashboarVM.getScheduleAnalysisData(i),this.project=e}createDonutChat(){b(this.svgConatiner.nativeElement).select("svg").remove();let t=this.svgConatiner.nativeElement.getBoundingClientRect(),i=Math.min(t.width,t.height)/2;this.svg=b(this.svgConatiner.nativeElement).append("svg").attr("width",i*2).attr("height",i*2).style("overflow","visible").append("g").attr("transform",`translate(${i}, ${i})`);let e=this.scheduleRatio;this.renderChart(e)}renderChart(t){let i=t.reduce((o,c)=>o+c.count,0),e=this.svgConatiner.nativeElement.getBoundingClientRect(),V=Math.min(e.width,e.height)/2,u=At().value(o=>o.count).sort(null),P=Vt().innerRadius(V*.5).outerRadius(V),Q=this.svg.selectAll("path").data(u(t));Q.transition().duration(1e3).attrTween("d",function(o){let c=this,f=G(c._current||o,o);return c._current=f(1),function(Rt){return P(f(Rt))}}).attr("fill",o=>this.color[o.data.status]),Q.enter().append("path").attr("d",P).attr("fill",o=>this.color[o.data.status]).attr("stroke","#fff").attr("stroke-width",2).each(function(o){this._current=o}).transition().duration(1e3).attrTween("d",function(o){let c=G({startAngle:0,endAngle:0},o);return this._current=c(1),function(f){return P(c(f))}});let H=this.svg.selectAll("text").data(u(t)),O="1.1em";H.attr("transform",o=>{let[c,f]=P.centroid(o);return`translate(${c}, ${f})`}).attr("text-anchor","middle").text("").each(function(o){if(o.data.count===0)return;let c=b(this);c.selectAll("tspan").remove(),c.append("tspan").attr("x",0).attr("dy","0em").style("font-size",O).text(o.data.status),c.append("tspan").attr("x",0).attr("dy",O).text(`${Math.round(o.data.count/i*100)}%`)}),H.enter().append("text").attr("transform",o=>{let[c,f]=P.centroid(o);return`translate(${c}, ${f})`}).attr("text-anchor","middle").style("font-size",O).style("fill","black").each(function(o){if(o.data.count===0)return;let c=b(this);c.selectAll("tspan").remove(),c.append("tspan").attr("x",0).attr("dy","0em").text(o.data.status),c.append("tspan").attr("x",0).attr("dy",O).style("font-size",O).text(`${Math.round(o.data.count/i*100)}%`)}),Q.exit().remove(),H.exit().remove()}static{this.\u0275fac=(()=>{let t;return function(e){return(t||(t=_(n)))(e||n)}})()}static{this.\u0275cmp=g({type:n,selectors:[["app-project-analysis"]],viewQuery:function(i,e){if(i&1&&$(Nt,7,T),i&2){let r;B(r=R())&&(e.svgConatiner=r.first)}},features:[w],decls:14,vars:1,consts:[["chatConatiner",""],[1,"container"],[1,"container-left"],[1,"project-selector"],[1,"custom-form-field"],[3,"ngModelChange","selectionChange","ngModel"],[3,"value"],[1,"project-chart"],[1,"container-right"],[1,"grid-item",3,"class"],[1,"grid-item"],[1,"item-header"],[2,"font-size","16px"],[1,"spacer"],[1,"item-body"],[1,"item"]],template:function(i,e){if(i&1){let r=K();l(0,"div",1)(1,"div",2)(2,"div",3)(3,"mat-form-field",4)(4,"mat-label"),d(5,"\uD504\uB85C\uC81D\uD2B8 \uC120\uD0DD"),a(),l(6,"mat-select",5),nt("ngModelChange",function(u){return N(r),et(e.selectedValue,u)||(e.selectedValue=u),q(u)}),Y("selectionChange",function(u){return N(r),q(e.onSelectionChange(u))}),y(7,qt,2,2,"mat-option",6,x),a()()(),v(9,"div",7,0),a(),l(11,"div",8),y(12,Lt,10,7,"div",9,x),a()()}i&2&&(s(6),tt("ngModel",e.selectedValue),s(),C(e.projects),s(5),C(e.scheduleRatio))},dependencies:[pt,mt,xt,gt,vt,dt],styles:['@charset "UTF-8";.container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;width:100%;height:auto}.container-left[_ngcontent-%COMP%], .container-right[_ngcontent-%COMP%]{height:auto}.container-left[_ngcontent-%COMP%]{flex:1.5}.container-right[_ngcontent-%COMP%]{flex:1;display:grid;grid-template-columns:repeat(2,1fr);gap:10px}.project-chart[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;min-width:200px;min-height:200px}.grid-item[_ngcontent-%COMP%]{display:flex;border:1px solid #ccc;font-size:20px;flex-direction:column;border-radius:5px;min-width:120px}.item-header[_ngcontent-%COMP%]{display:flex;padding:10px 15px}.item-body[_ngcontent-%COMP%]{flex:1;border-radius:10px;margin:10px;display:flex;align-items:center;justify-content:center}.item[_ngcontent-%COMP%]{color:#fff}.spacer[_ngcontent-%COMP%]{flex:1}.all-lighten[_ngcontent-%COMP%]{background-color:#82c4f8}.all-darken[_ngcontent-%COMP%]{background-color:#0c7cd5}.receive-lighten[_ngcontent-%COMP%]{background-color:#f1f8fe}.receive-darken[_ngcontent-%COMP%]{background-color:#60b3f6}.progress-lighten[_ngcontent-%COMP%]{background-color:#ffe0b3}.progress-darken[_ngcontent-%COMP%]{background-color:#ffa21a}.complete-lighten[_ngcontent-%COMP%]{background-color:#addaaf}.complete-darken[_ngcontent-%COMP%]{background-color:#49a54e}  .mdc-text-field--filled{background-color:transparent!important}  .custom-form-field .mat-select{height:20px;line-height:20px;padding:0}  .custom-form-field .mat-select-trigger{height:20px;line-height:20px;padding:0 8px}  .custom-form-field .mat-form-field-flex{height:20px;align-items:center}  .custom-form-field .mat-form-field-wrapper{height:20px;align-items:center}']})}}return n})();var Ut=["chartContainer"],Et=(()=>{class n extends D{constructor(){super(...arguments),this.dashboardVM=h(M),this.margin={top:10,right:10,bottom:20,left:30},this.dummyData=this.generateDummyData()}ngOnInit(){this.dashboardVM.getScheduleCompleteData(),this.dashboardVM.scheduleCompleteData$.pipe(S(this.destroy$)).subscribe(t=>{t&&this.updateChart(t)})}ngAfterViewInit(){requestAnimationFrame(()=>{this.initializeChart()})}ngOnDestroy(){this.destroy$.next(),this.dashboardVM.scheduleCompleteData$.next(null)}generateDummyData(){let t=new Date;return Array.from({length:30},(i,e)=>{let r=new Date;return r.setDate(t.getDate()-(29-e)),{date:r,count:0}})}initializeChart(){let t=this.chartContainer.nativeElement.getBoundingClientRect();console.log("\uD604\uC7AC \uCEE8\uD14C\uC774\uB108 \uD06C\uAE30, ",t),this.svg=b(this.chartContainer.nativeElement).append("svg").attr("width",t.width).attr("height",t.height).append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),this.x=jt().range([0,t.width-this.margin.left-this.margin.right]),this.y=St().range([t.height-this.margin.top-this.margin.bottom,0]),this.svg.append("g").attr("class","x-axis").attr("transform",`translate(0,${t.height-this.margin.top-this.margin.bottom})`),this.svg.append("g").attr("class","y-axis"),this.updateChart(this.dummyData)}updateChart(t){this.x.domain(wt(t,e=>e.date)),this.y.domain([0,Dt(t,e=>e.count)||0]),this.svg.select(".x-axis").transition().duration(1e3).call(Pt(this.x).tickFormat(Ft("%b %d"))),this.svg.select(".y-axis").transition().duration(1e3).call(Ot(this.y)),this.svg.select(".x-axis").selectAll("text").attr("transform","rotate(-45)").style("text-anchor","end");let i=It().x(e=>this.x(e.date)).y(e=>this.y(e.count)).curve(Tt);this.svg.selectAll(".line").data([t]).join(e=>e.append("path").attr("class","line").attr("fill","none").attr("stroke","steelblue").attr("stroke-width",2).attr("d",i),e=>e.transition().duration(1e3).attr("d",i),e=>e.remove()),this.svg.selectAll(".point").data(t).join(e=>e.append("circle").attr("class","point").attr("r",1).attr("fill","steelblue").attr("cx",r=>this.x(r.date)).attr("cy",r=>this.y(r.count)),e=>e.transition().duration(1e3).attr("cx",r=>this.x(r.date)).attr("cy",r=>this.y(r.count)),e=>e.remove())}static{this.\u0275fac=(()=>{let t;return function(e){return(t||(t=_(n)))(e||n)}})()}static{this.\u0275cmp=g({type:n,selectors:[["app-schedule-complete-chart"]],viewQuery:function(i,e){if(i&1&&$(Ut,7,T),i&2){let r;B(r=R())&&(e.chartContainer=r.first)}},features:[w],decls:7,vars:1,consts:[["chartContainer",""],[1,"container"],[1,""],[1,"chart-container"]],template:function(i,e){i&1&&(l(0,"div",1)(1,"div")(2,"mat-toolbar",2)(3,"span"),d(4),a()()(),v(5,"div",3,0),a()),i&2&&(s(4),p(e.data.title))},dependencies:[W],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}.chart-container[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;width:100%;height:100%}"]})}}return n})();var Gt=n=>({data:n});function Xt(n,m){n&1&&J(0,6)}function Jt(n,m){if(n&1&&(l(0,"div",4),X(1,Xt,1,0,"ng-container",5),a()),n&2){let t=m.$implicit;E(t.style),s(),k("ngComponentOutlet",t.component)("ngComponentOutletInputs",it(4,Gt,t.data))}}function Kt(n,m){if(n&1&&(l(0,"div",2),y(1,Jt,2,6,"div",3,x),a()),n&2){let t=m.$implicit;E(t.style),s(),C(t.columns)}}var $t=(()=>{class n{constructor(){this.dashboardVM=h(M),this.gridStyle={display:"flex",flexDirection:"column",gap:"10px",width:"100%",height:"100%",overflow:"auto",padding:"10px"},this.configs=[{style:{display:"flex",flexWrap:"wrap",gap:"10px",width:"100%"},columns:[{component:z,style:{flex:"1",minWidth:"200px",padding:"10px",minHeight:"300px"},data:{title:"\uC624\uB298 \uC77C\uC815"}},{component:kt,style:{flex:"2",minWidth:"200px",padding:"10px",minHeight:"300px"},data:{title:"\uD504\uB85C\uC81D\uD2B8 \uBD84\uC11D"}}]},{style:{display:"flex",flexWrap:"wrap",gap:"10px",width:"100%"},columns:[{component:Et,style:{flex:"1",minWidth:"200px",padding:"10px",minHeight:"300px"},data:{title:"\uC644\uB8CC\uD55C \uC77C\uC815"}},{component:z,style:{flex:"1",minWidth:"200px",padding:"10px",minHeight:"300px"},data:{title:"\uC624\uB298 \uC77C\uC815"}},{component:z,style:{flex:"1",minWidth:"200px",padding:"10px",minHeight:"300px"},data:{title:"\uC624\uB298 \uC77C\uC815"}}]}]}ngOnInit(){this.dashboardVM.getTodayScheduleFromServer()}setGridColumns(t){}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=g({type:n,selectors:[["app-dashboard"]],decls:3,vars:2,consts:[[1,"container"],[1,"grid-row",3,"style"],[1,"grid-row"],[1,"grid-column",3,"style"],[1,"grid-column"],["style","width: 100%; height: 100%;",4,"ngComponentOutlet","ngComponentOutletInputs"],[2,"width","100%","height","100%"]],template:function(i,e){i&1&&(l(0,"div",0),y(1,Kt,3,2,"div",1,x),a()),i&2&&(E(e.gridStyle),s(),C(e.configs))},dependencies:[rt],styles:["[_nghost-%COMP%]{flex:1}.spacer[_ngcontent-%COMP%]{flex:1}"]})}}return n})();var Yt=[{path:"",component:$t,children:[]}],Bt=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=A({type:n})}static{this.\u0275inj=I({imports:[U.forChild(Yt),U]})}}return n})();var Je=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=A({type:n})}static{this.\u0275inj=I({imports:[Bt,ct,Mt,ft,ht,yt,bt,Ct]})}}return n})();export{Je as DashboardModule};
