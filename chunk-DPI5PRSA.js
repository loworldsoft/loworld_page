import{P as at,Q as st,W as lt,c as nt,e as ot,f as it,m as rt}from"./chunk-ZIDVXYMS.js";import{$ as K,$b as J,Jb as z,Kb as f,Lb as C,Lc as et,Mb as tt,Qb as $,Ub as T,Vb as A,Zb as q,_ as G,_a as S,_b as X,a as U,d as k,db as Q,ec as B,fc as L,ia as E,ic as P,ja as M,k as W,kb as R,lb as Z,pb as Y,rb as V,ya as j}from"./chunk-AQFBZUJQ.js";var ct=class h{static \u0275fac=function(e){return new(e||h)};static \u0275mod=Z({type:h});static \u0275inj=K({imports:[rt,lt]})};var gt=class h{constructor(){}extractTextStreamAsJson(t){return k(this,null,function*(){try{console.log("\u{1F4C4} PDF \uD14D\uC2A4\uD2B8 \uC2A4\uD2B8\uB9BC \uCD94\uCD9C \uC2DC\uC791:",t.name);let e={fileName:t.name,fileSize:t.size,pageCount:0,extractionTimestamp:new Date().toISOString(),extractionMethod:"PDF.js + \uD5A5\uC0C1\uB41C \uBD84\uC11D",pages:[],metadata:{totalTextItems:0,totalWords:0,totalCharacters:0,uniqueFonts:[],hasImages:!1,hasVectorGraphics:!1}},n=yield t.arrayBuffer();if(typeof window.pdfjsLib<"u"){let o=window.pdfjsLib;o.GlobalWorkerOptions.workerSrc||(o.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js");let i=yield o.getDocument({data:n}).promise;e.pageCount=i.numPages,console.log(`\u{1F4CA} \uCD1D \uD398\uC774\uC9C0 \uC218: ${i.numPages}`);let a=new Set,g=0,c=0,u=0;for(let x=1;x<=i.numPages;x++){console.log(`\u{1F4C4} \uD398\uC774\uC9C0 ${x} \uCC98\uB9AC \uC911...`);let _=yield i.getPage(x),y=_.getViewport({scale:1}),d=yield _.getTextContent(),p=yield this.extractTextColorsFromOperatorList(_),m=d.items.map((w,D)=>{let F=w.transform,ht={id:`page-${x}-item-${D}`,text:w.str,position:{x:Math.round(F[4]*100)/100,y:Math.round((y.height-F[5])*100)/100,width:Math.round(w.width*100)/100,height:Math.round(w.height*100)/100},font:{name:w.fontName||"Unknown",size:Math.round(Math.abs(F[0])*100)/100},transform:F,style:{direction:w.dir||"ltr",hasEndOfLine:w.hasEOL||!1,color:p[D]||"#000000"},analysis:this.analyzeText(w.str)};return w.fontName&&a.add(w.fontName),ht}).filter(w=>w.text.trim().length>0),b=this.groupTextIntoSentences(m),O=this.calculatePageStatistics(m),v={pageNumber:x,width:Math.round(y.width),height:Math.round(y.height),textItems:m,sentences:b,statistics:O};e.pages.push(v),g+=m.length,c+=O.wordCount,u+=O.charCount}let s=yield this.checkForVectorGraphics(i),l;if(s)try{l=yield this.extractVectorGraphicsDetails(i)}catch(x){console.warn("\u26A0\uFE0F \uBCA1\uD130 \uADF8\uB798\uD53D \uC0C1\uC138 \uC815\uBCF4 \uCD94\uCD9C \uC2E4\uD328:",x)}return e.metadata={totalTextItems:g,totalWords:c,totalCharacters:u,uniqueFonts:Array.from(a),hasImages:yield this.checkForImages(i),hasVectorGraphics:s,vectorGraphicsDetails:l},console.log("\u2705 \uD14D\uC2A4\uD2B8 \uC2A4\uD2B8\uB9BC \uCD94\uCD9C \uC644\uB8CC"),console.log(`\u{1F4CA} \uD1B5\uACC4: ${g}\uAC1C \uD14D\uC2A4\uD2B8 \uC544\uC774\uD15C, ${c}\uAC1C \uB2E8\uC5B4, ${u}\uAC1C \uBB38\uC790`),e}throw new Error("PDF.js \uB77C\uC774\uBE0C\uB7EC\uB9AC\uB97C \uC0AC\uC6A9\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4")}catch(e){throw console.error("\u274C \uD14D\uC2A4\uD2B8 \uC2A4\uD2B8\uB9BC \uCD94\uCD9C \uC624\uB958:",e),e}})}analyzeText(t){let e=t.trim().split(/\s+/).filter(o=>o.length>0).length,n=t.length;return{wordCount:e,charCount:n,containsEnglish:/[a-zA-Z]/.test(t),containsKorean:/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/.test(t),containsNumbers:/[0-9]/.test(t),containsSpecialChars:/[!@#$%^&*(),.?":{}|<>]/.test(t)}}groupTextIntoSentences(t){let e=[],n={text:"",items:[],x:null,y:null,width:0,height:0};return t.forEach((o,r)=>{if(n.x===null&&(n.x=o.position.x,n.y=o.position.y),n.text+=o.text,n.items.push(o),n.width+=o.position.width,n.height=Math.max(n.height,o.position.height),(o.style.hasEndOfLine||o.text.includes(".")||o.text.includes("!")||o.text.includes("?")||r===t.length-1)&&n.text.trim()){let a=n.text.trim();e.push({id:`sentence-${e.length+1}`,text:a,position:{x:n.x||0,y:n.y||0,width:n.width,height:n.height},itemCount:n.items.length,itemIds:n.items.map(g=>g.id),language:this.detectLanguage(a)}),n={text:"",items:[],x:null,y:null,width:0,height:0}}}),e}detectLanguage(t){let e=/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/.test(t),n=/[a-zA-Z]/.test(t);return e&&n?"mixed":e?"korean":n?"english":"unknown"}calculatePageStatistics(t){let e=t.reduce((i,a)=>i+a.analysis.wordCount,0),n=t.reduce((i,a)=>i+a.analysis.charCount,0),o=t.length>0?t.reduce((i,a)=>i+a.font.size,0)/t.length:0,r={};return t.forEach(i=>{r[i.font.name]=(r[i.font.name]||0)+1}),{totalItems:t.length,wordCount:e,charCount:n,avgFontSize:Math.round(o*100)/100,fontDistribution:r}}checkForImages(t){return k(this,null,function*(){try{for(let e=1;e<=t.numPages;e++){let o=yield(yield t.getPage(e)).getOperatorList({intent:"display"});for(let r=0;r<o.fnArray.length;r++){let i=o.fnArray[r];if(i===window.pdfjsLib.OPS.paintImageXObject||i===window.pdfjsLib.OPS.paintInlineImageXObject)return!0}}}catch(e){console.warn("\uC774\uBBF8\uC9C0 \uD655\uC778 \uC911 \uC624\uB958:",e)}return!1})}checkForVectorGraphics(t){return k(this,null,function*(){try{for(let e=1;e<=t.numPages;e++){let o=yield(yield t.getPage(e)).getOperatorList({intent:"display"});for(let r=0;r<o.fnArray.length;r++){let i=o.fnArray[r];if(i===window.pdfjsLib.OPS.moveTo||i===window.pdfjsLib.OPS.lineTo||i===window.pdfjsLib.OPS.curveTo||i===window.pdfjsLib.OPS.rectangle||i===window.pdfjsLib.OPS.fill||i===window.pdfjsLib.OPS.stroke)return!0}}}catch(e){console.warn("\uBCA1\uD130 \uADF8\uB798\uD53D \uD655\uC778 \uC911 \uC624\uB958:",e)}return!1})}extractVectorGraphicsDetails(t){return k(this,null,function*(){console.log("\u{1F3A8} \uBCA1\uD130 \uADF8\uB798\uD53D \uC0C1\uC138 \uC815\uBCF4 \uCD94\uCD9C \uC2DC\uC791...");let e={totalOperations:0,summary:{totalPaths:0,totalLines:0,totalCurves:0,totalRectangles:0,totalFillOperations:0,totalStrokeOperations:0,totalClipOperations:0},pageDetails:[]};try{for(let n=1;n<=t.numPages;n++){let o=yield t.getPage(n),r=yield o.getOperatorList({intent:"display"}),i={pageNumber:n,operations:[],statistics:{pathCount:0,lineCount:0,curveCount:0,rectangleCount:0,fillCount:0,strokeCount:0,clipCount:0}};for(let g=0;g<r.fnArray.length;g++){let c=r.fnArray[g],u=r.argsArray[g],s=null,l=!1;c===1?(s="moveTo",l=!0,i.statistics.pathCount++,e.summary.totalPaths++):c===2?(s="lineTo",l=!0,i.statistics.lineCount++,e.summary.totalLines++):c>=3&&c<=6?(s="curve",l=!0,i.statistics.curveCount++,e.summary.totalCurves++):c===7?(s="rectangle",l=!0,i.statistics.rectangleCount++,e.summary.totalRectangles++):c===9?(s="closePath",l=!0):c===22?(s="fill",l=!0,i.statistics.fillCount++,e.summary.totalFillOperations++):c===20?(s="stroke",l=!0,i.statistics.strokeCount++,e.summary.totalStrokeOperations++):c===29?(s="clip",l=!0,i.statistics.clipCount++,e.summary.totalClipOperations++):c>=31&&c<=34?(s="matrixTransform",l=!1):c>=10&&c<=12?(s="styleSettings",l=!1):[28,37,42,44,58,59,70,71,91].includes(c)&&(u&&Array.isArray(u)&&u.length>=2&&typeof u[u.length-2]=="number"&&typeof u[u.length-1]=="number"?(s="unknownVectorGraphic",l=!0):(s="unknownOperation",l=!1)),s&&(l||s.includes("Transform")||s.includes("Settings"))&&(i.operations.push({type:s,args:u||[],opCode:c,isVectorGraphic:l,coordinates:this.extractCoordinates(u)}),l&&e.totalOperations++)}i.operations.length>0&&(e.pageDetails.push(i),console.log(`\u{1F4C4} \uD398\uC774\uC9C0 ${n} OperatorList: ${i.operations.length}\uAC1C \uC5F0\uC0B0`)),console.log(`\u{1F3A8} \uD398\uC774\uC9C0 ${n} SVG \uB80C\uB354\uB9C1 \uC911...`);let a=yield this.extractVectorGraphicsFromSVG(o,window.pdfjsLib);console.log(`\u2705 \uD398\uC774\uC9C0 ${n} SVG \uBD84\uC11D:`,{paths:a.totalPaths,lines:a.totalLines,curves:a.totalCurves,fills:a.totalFills}),e.summary.totalPaths+=a.totalPaths,e.summary.totalLines+=a.totalLines,e.summary.totalCurves+=a.totalCurves}return console.log("\u2705 \uBCA1\uD130 \uADF8\uB798\uD53D \uC0C1\uC138 \uBD84\uC11D \uC644\uB8CC:",{totalOperations:e.totalOperations,totalPaths:e.summary.totalPaths,totalPages:e.pageDetails.length}),e}catch(n){throw console.error("\u274C \uBCA1\uD130 \uADF8\uB798\uD53D \uC0C1\uC138 \uC815\uBCF4 \uCD94\uCD9C \uC624\uB958:",n),n}})}extractTextColorsFromOperatorList(t){return k(this,null,function*(){try{let e=yield t.getOperatorList({intent:"display"}),n=e.fnArray,o=e.argsArray,i=window.pdfjsLib.OPS,a=[],g="#000000",c="DeviceRGB";console.log(`\u{1F3A8} \uC0C9\uC0C1 \uCD94\uCD9C \uC2DC\uC791 - \uCD1D ${n.length}\uAC1C \uC5F0\uC0B0`);for(let u=0;u<n.length;u++){let s=n[u],l=o[u];if(s===i.setFillColorSpace)c=l[0]?.name||l[0]||"DeviceRGB",console.log(`\u{1F3A8} \uC0C9\uC0C1 \uACF5\uAC04 \uBCC0\uACBD: ${c}`);else if(s===i.setFillRGBColor){let x=Math.round(l[0]*255),_=Math.round(l[1]*255),y=Math.round(l[2]*255);g=`#${x.toString(16).padStart(2,"0")}${_.toString(16).padStart(2,"0")}${y.toString(16).padStart(2,"0")}`,console.log(`\u{1F3A8} RGB \uC0C9\uC0C1 \uC124\uC815: R=${l[0]}, G=${l[1]}, B=${l[2]} \u2192 ${g}`)}else if(s===i.setFillGray){let x=Math.round(l[0]*255);g=`#${x.toString(16).padStart(2,"0")}${x.toString(16).padStart(2,"0")}${x.toString(16).padStart(2,"0")}`,console.log(`\u{1F3A8} Gray \uC0C9\uC0C1 \uC124\uC815: ${l[0]} \u2192 ${g}`)}else if(s===i.setFillCMYKColor){let x=l[0],_=l[1],y=l[2],d=l[3],p=Math.round(255*(1-x)*(1-d)),m=Math.round(255*(1-_)*(1-d)),b=Math.round(255*(1-y)*(1-d));g=`#${p.toString(16).padStart(2,"0")}${m.toString(16).padStart(2,"0")}${b.toString(16).padStart(2,"0")}`,console.log(`\u{1F3A8} CMYK \uC0C9\uC0C1 \uC124\uC815: C=${x}, M=${_}, Y=${y}, K=${d} \u2192 ${g}`)}else if(s===i.setFillColor){if(console.log(`\u{1F3A8} setFillColor \uD638\uCD9C: colorSpace=${c}, args=`,l),c==="DeviceRGB"&&l.length>=3){let x=Math.round(l[0]*255),_=Math.round(l[1]*255),y=Math.round(l[2]*255);g=`#${x.toString(16).padStart(2,"0")}${_.toString(16).padStart(2,"0")}${y.toString(16).padStart(2,"0")}`,console.log(`\u{1F3A8} setFillColor RGB: ${g}`)}else if(c==="DeviceGray"&&l.length>=1){let x=Math.round(l[0]*255);g=`#${x.toString(16).padStart(2,"0")}${x.toString(16).padStart(2,"0")}${x.toString(16).padStart(2,"0")}`,console.log(`\u{1F3A8} setFillColor Gray: ${g}`)}else if(c==="DeviceCMYK"&&l.length>=4){let x=l[0],_=l[1],y=l[2],d=l[3],p=Math.round(255*(1-x)*(1-d)),m=Math.round(255*(1-_)*(1-d)),b=Math.round(255*(1-y)*(1-d));g=`#${p.toString(16).padStart(2,"0")}${m.toString(16).padStart(2,"0")}${b.toString(16).padStart(2,"0")}`,console.log(`\u{1F3A8} setFillColor CMYK: ${g}`)}}else(s===i.showText||s===i.showSpacedText||s===i.nextLineShowText)&&(a.push(g),console.log(`\u{1F4DD} \uD14D\uC2A4\uD2B8 \uD45C\uC2DC (${a.length}\uBC88\uC9F8): \uC0C9\uC0C1=${g}`))}return console.log(`\u2705 \uC0C9\uC0C1 \uCD94\uCD9C \uC644\uB8CC - \uCD1D ${a.length}\uAC1C \uD14D\uC2A4\uD2B8 \uD56D\uBAA9`),a}catch(e){return console.warn("\u26A0\uFE0F \uD14D\uC2A4\uD2B8 \uC0C9\uC0C1 \uCD94\uCD9C \uC2E4\uD328:",e),[]}})}downloadJsonData(t){try{let e=JSON.stringify(t,null,2),n=new Blob([e],{type:"application/json;charset=utf-8;"}),o=document.createElement("a"),r=URL.createObjectURL(n),i=new Date().toISOString().split("T")[0],a=`${t.fileName}_text_stream_${i}.json`;o.setAttribute("href",r),o.setAttribute("download",a),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r),console.log(`\u2705 JSON \uD30C\uC77C \uB2E4\uC6B4\uB85C\uB4DC \uC644\uB8CC: ${a}`)}catch(e){throw console.error("\u274C JSON \uD30C\uC77C \uB2E4\uC6B4\uB85C\uB4DC \uC624\uB958:",e),e}}logJsonData(t){console.group("\u{1F4C4} PDF \uD14D\uC2A4\uD2B8 \uC2A4\uD2B8\uB9BC JSON \uB370\uC774\uD130"),console.log("\u{1F4CA} \uAE30\uBCF8 \uC815\uBCF4:",{fileName:t.fileName,fileSize:t.fileSize,pageCount:t.pageCount,extractionTimestamp:t.extractionTimestamp}),console.log("\u{1F4C8} \uD1B5\uACC4:",t.metadata),console.log("\uFFFD \uC5B8\uC5B4 \uD1B5\uACC4:",t.metadata.languageDetection),console.log("\uFFFD\u{1F4DD} \uD398\uC774\uC9C0\uBCC4 \uC694\uC57D:",t.pages.map(e=>({page:e.pageNumber,textItems:e.statistics.totalItems,words:e.statistics.wordCount,englishCount:e.statistics.englishTextCount||0,koreanCount:e.statistics.koreanTextCount||0}))),console.log("\u{1F4C4} \uC804\uCCB4 JSON \uB370\uC774\uD130:",t),console.groupEnd()}processFileWithAutoExtraction(t){return k(this,null,function*(){try{console.log("\u{1F680} PDF \uD30C\uC77C \uCC98\uB9AC \uC2DC\uC791 (\uC790\uB3D9 \uD14D\uC2A4\uD2B8 \uC2A4\uD2B8\uB9BC \uCD94\uCD9C):",t.name);let e=yield this.extractTextStreamAsJson(t);this.logJsonData(e);let n=this.generateSummary(e);return console.log(`\u{1F4CB} \uC694\uC57D \uC815\uBCF4:
`+n),e}catch(e){throw console.error("\u274C PDF \uD30C\uC77C \uCC98\uB9AC \uC2E4\uD328:",e),e}})}filterTextByCondition(t,e){let n=[];return t.pages.forEach(o=>{e.pageNumber&&o.pageNumber!==e.pageNumber||o.textItems.forEach(r=>{let i=!0;e.containsEnglish!==void 0&&(i=i&&r.analysis.containsEnglish===e.containsEnglish),e.containsKorean!==void 0&&(i=i&&r.analysis.containsKorean===e.containsKorean),e.minFontSize!==void 0&&(i=i&&r.font.size>=e.minFontSize),e.maxFontSize!==void 0&&(i=i&&r.font.size<=e.maxFontSize),i&&n.push(r)})}),n}generateSummary(t){return[`\u{1F4C4} PDF \uD30C\uC77C: ${t.fileName}`,"\u{1F4CA} \uAE30\uBCF8 \uC815\uBCF4:",`   - \uD30C\uC77C \uD06C\uAE30: ${this.formatFileSize(t.fileSize)}`,`   - \uD398\uC774\uC9C0 \uC218: ${t.pageCount}`,`   - \uCD94\uCD9C \uC2DC\uAC04: ${new Date(t.extractionTimestamp).toLocaleString("ko-KR")}`,"","\u{1F4C8} \uD14D\uC2A4\uD2B8 \uD1B5\uACC4:",`   - \uCD1D \uD14D\uC2A4\uD2B8 \uC544\uC774\uD15C: ${t.metadata.totalTextItems.toLocaleString()}\uAC1C`,`   - \uCD1D \uB2E8\uC5B4 \uC218: ${t.metadata.totalWords.toLocaleString()}\uAC1C`,`   - \uCD1D \uBB38\uC790 \uC218: ${t.metadata.totalCharacters.toLocaleString()}\uAC1C`,`   - \uC0AC\uC6A9\uB41C \uD3F0\uD2B8: ${t.metadata.uniqueFonts.length}\uAC1C`,"","\u{1F5BC}\uFE0F \uBBF8\uB514\uC5B4 \uC694\uC18C:",`   - \uC774\uBBF8\uC9C0 \uD3EC\uD568: ${t.metadata.hasImages?"\uC608":"\uC544\uB2C8\uC624"}`,`   - \uBCA1\uD130 \uADF8\uB798\uD53D \uD3EC\uD568: ${t.metadata.hasVectorGraphics?"\uC608":"\uC544\uB2C8\uC624"}`,"","\u{1F4DD} \uD398\uC774\uC9C0\uBCC4 \uC0C1\uC138:",...t.pages.map(n=>`   \uD398\uC774\uC9C0 ${n.pageNumber}: ${n.statistics.totalItems}\uAC1C \uD14D\uC2A4\uD2B8, ${n.statistics.wordCount}\uB2E8\uC5B4`)].join(`
`)}formatFileSize(t){if(t===0)return"0 Bytes";let e=1024,n=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,o)).toFixed(2))+" "+n[o]}extractVectorStreamData(t){return k(this,null,function*(){console.log("\u{1F3A8} \uBCA1\uD130 \uC2A4\uD2B8\uB9BC \uB370\uC774\uD130 \uCD94\uCD9C \uC2DC\uC791...");let e=yield t.arrayBuffer(),n=yield window.pdfjsLib.getDocument(e).promise,o={fileName:t.name.replace(/\.[^/.]+$/,""),fileSize:t.size,pageCount:n.numPages,extractionTimestamp:new Date().toISOString(),extractionMethod:"PDF.js OperatorList Analysis",totalOperations:0,summary:{totalPaths:0,totalLines:0,totalCurves:0,totalRectangles:0,totalFillOperations:0,totalStrokeOperations:0,totalClipOperations:0},pageDetails:[],debugInfo:{totalOperatorsFound:0,recognizedOperators:0,unrecognizedOperators:0,uniqueOperatorCodes:[]}},r=new Set;try{for(let i=1;i<=n.numPages;i++){let a=yield n.getPage(i),g=yield a.getOperatorList({intent:"display"});o.debugInfo.totalOperatorsFound+=g.fnArray.length,g.fnArray.forEach(y=>r.add(y));let c={pageNumber:i,operations:[],statistics:{pathCount:0,lineCount:0,curveCount:0,rectangleCount:0,fillCount:0,strokeCount:0,clipCount:0}},u=[],s=!1,l=null,x=[];for(let y=0;y<g.fnArray.length;y++){let d=g.fnArray[y],p=g.argsArray[y],m="",b=!1;if(d===30)l&&x.push([...l]);else if(d===31)p&&p.length>=6&&(l=p.slice(0,6)),m="matrixTransform";else if(d===32)x.length>0&&(l=x.pop()||null);else if(d===1)p&&p.length>=2&&(u.push({type:"moveTo",coords:[p[0],p[1]]}),s=!0),m="moveTo",b=!0,c.statistics.pathCount++,o.summary.totalPaths++;else if(d===2)p&&p.length>=2&&(u.push({type:"lineTo",coords:[p[0],p[1]]}),s=!0),m="lineTo",b=!0,c.statistics.lineCount++,o.summary.totalLines++;else if(d>=3&&d<=6)p&&p.length>=6&&(u.push({type:"curve",coords:p.slice(0,6)}),s=!0),m="curve",b=!0,c.statistics.curveCount++,o.summary.totalCurves++;else if(d===7)p&&p.length>=4&&(u.push({type:"rectangle",coords:[p[0],p[1],p[2],p[3]]}),s=!0),m="rectangle",b=!0,c.statistics.rectangleCount++,o.summary.totalRectangles++;else if(d===9)s&&u.push({type:"closePath",coords:[]}),m="closePath",b=!0;else if(d===22){if(m="fill",b=!0,c.statistics.fillCount++,o.summary.totalFillOperations++,!s&&l){let O=l[4],v=l[5],w=l[0],D=l[3],F=Math.max(Math.abs(w),Math.abs(D),1);u.push({type:"implicitRect",coords:[O,v,F,F]}),s=!0,console.log(`\u{1F538} \uC554\uBB35\uC801 fill path \uC0DD\uC131: (${O.toFixed(2)}, ${v.toFixed(2)}) ${F.toFixed(2)}x${F.toFixed(2)}`)}}else d===20?(m="stroke",b=!0,c.statistics.strokeCount++,o.summary.totalStrokeOperations++):d===29?(m="clip",b=!0,c.statistics.clipCount++,o.summary.totalClipOperations++):d===12?(p&&p.length===6&&(l=p.slice(0,6)),m="styleSettings"):d>=10&&d<=11?m="styleSettings":[28,37,42,44,58,59,70,71,91].includes(d)&&(p&&Array.isArray(p)&&p.length>=2&&typeof p[p.length-2]=="number"&&typeof p[p.length-1]=="number"?(m="unknownVectorGraphic",b=!0):(m="unknownOperation",b=!1));if(m&&(b||m.includes("Transform")||m.includes("Settings"))){let O={type:m,args:p||[],opCode:d,opName:this.getOpName(d)||`code_${d}`,isVectorGraphic:b,coordinates:this.extractCoordinates(p)};(m==="fill"||m==="stroke")&&u.length>0&&(O.currentPath=[...u],O.pathSegments=u.length),l&&(O.transformMatrix=[...l]),c.operations.push(O),b&&(o.totalOperations++,o.debugInfo.recognizedOperators++),(m==="fill"||m==="stroke")&&(u=[],s=!1)}else o.debugInfo.unrecognizedOperators++}console.log(`\u{1F4C4} \uD398\uC774\uC9C0 ${i} OperatorList: ${c.operations.length}\uAC1C \uC5F0\uC0B0`),console.log(`\u{1F3A8} \uD398\uC774\uC9C0 ${i} SVG \uC0DD\uC131 \uC911...`);try{let y=a.getViewport({scale:1}),d=yield a.getOperatorList({intent:"display"}),m=yield new window.pdfjsLib.SVGGraphics(a.commonObjs,a.objs).getSVG(d,y),b=m.querySelectorAll("text, tspan");b.forEach(w=>w.remove()),console.log(`\u{1F5D1}\uFE0F ${b.length}\uAC1C\uC758 \uD14D\uC2A4\uD2B8 \uC694\uC18C \uC81C\uAC70\uB428`);let v=new XMLSerializer().serializeToString(m);v=v.replace(/<svg:svg/g,"<svg").replace(/<\/svg:svg>/g,"</svg>").replace(/<svg:g/g,"<g").replace(/<\/svg:g>/g,"</g>").replace(/<svg:path/g,"<path").replace(/<\/svg:path>/g,"</path>").replace(/<svg:rect/g,"<rect").replace(/<\/svg:rect>/g,"</rect>").replace(/<svg:line/g,"<line").replace(/<\/svg:line>/g,"</line>").replace(/<svg:circle/g,"<circle").replace(/<\/svg:circle>/g,"</circle>").replace(/<svg:ellipse/g,"<ellipse").replace(/<\/svg:ellipse>/g,"</ellipse>").replace(/<svg:polygon/g,"<polygon").replace(/<\/svg:polygon>/g,"</polygon>").replace(/<svg:polyline/g,"<polyline").replace(/<\/svg:polyline>/g,"</polyline>").replace(/<svg:text/g,"<text").replace(/<\/svg:text>/g,"</text>").replace(/<svg:tspan/g,"<tspan").replace(/<\/svg:tspan>/g,"</tspan>").replace(/xmlns:svg="[^"]*"/g,"").replace(/xmlns:xlink="[^"]*"/g,'xmlns:xlink="http://www.w3.org/1999/xlink"').replace(/<svg /g,'<svg xmlns="http://www.w3.org/2000/svg" '),c.svgContent=v,console.log(`\u2705 \uD398\uC774\uC9C0 ${i} SVG \uC0DD\uC131 \uC644\uB8CC (\uAE38\uC774: ${c.svgContent.length}\uC790)`),console.log("\u{1F50D} SVG \uC2DC\uC791 \uBD80\uBD84:",c.svgContent.substring(0,200))}catch(y){console.error(`\u274C \uD398\uC774\uC9C0 ${i} SVG \uC0DD\uC131 \uC2E4\uD328:`,y),c.svgContent=void 0}(c.operations.length>0||c.svgContent)&&(o.pageDetails.push(c),console.log(`\u{1F4E6} \uD398\uC774\uC9C0 ${i} pageDetails\uC5D0 \uCD94\uAC00\uB428 (SVG: ${c.svgContent?"YES":"NO"})`)),console.log(`\u{1F3A8} \uD398\uC774\uC9C0 ${i} SVG \uBD84\uC11D \uC911...`);let _=yield this.extractVectorGraphicsFromSVG(a,window.pdfjsLib);console.log(`\u2705 \uD398\uC774\uC9C0 ${i} SVG \uBD84\uC11D \uC644\uB8CC:`,{paths:_.totalPaths,lines:_.totalLines,curves:_.totalCurves,fills:_.totalFills}),o.summary.totalPaths+=_.totalPaths,o.summary.totalLines+=_.totalLines,o.summary.totalCurves+=_.totalCurves,console.log(`\u{1F4CA} \uD398\uC774\uC9C0 ${i} \uB204\uC801 \uD1B5\uACC4:`,{totalPaths:o.summary.totalPaths,totalLines:o.summary.totalLines,totalCurves:o.summary.totalCurves,totalFills:o.summary.totalFillOperations})}return o.debugInfo.uniqueOperatorCodes=Array.from(r).sort(),o.extractionMethod="PDF.js OperatorList + SVG Rendering (Hybrid)",console.log("\u2705 \uBCA1\uD130 \uC2A4\uD2B8\uB9BC \uB370\uC774\uD130 \uCD94\uCD9C \uC644\uB8CC:",{totalOperations:o.totalOperations,recognizedOperators:o.debugInfo.recognizedOperators,unrecognizedOperators:o.debugInfo.unrecognizedOperators}),o}catch(i){throw console.error("\u274C \uBCA1\uD130 \uC2A4\uD2B8\uB9BC \uB370\uC774\uD130 \uCD94\uCD9C \uC624\uB958:",i),i}})}downloadVectorStreamJson(t){try{let e=JSON.stringify(t,null,2),n=new Blob([e],{type:"application/json;charset=utf-8;"}),o=document.createElement("a"),r=URL.createObjectURL(n),i=new Date().toISOString().split("T")[0],a=`${t.fileName}_vector_stream_${i}.json`;o.setAttribute("href",r),o.setAttribute("download",a),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r),console.log(`\u2705 \uBCA1\uD130 \uC2A4\uD2B8\uB9BC JSON \uD30C\uC77C \uB2E4\uC6B4\uB85C\uB4DC \uC644\uB8CC: ${a}`)}catch(e){throw console.error("\u274C \uBCA1\uD130 \uC2A4\uD2B8\uB9BC JSON \uD30C\uC77C \uB2E4\uC6B4\uB85C\uB4DC \uC624\uB958:",e),e}}logVectorStreamJson(t){console.group("\u{1F3A8} PDF \uBCA1\uD130 \uC2A4\uD2B8\uB9BC JSON \uB370\uC774\uD130"),console.log("\u{1F4CA} \uAE30\uBCF8 \uC815\uBCF4:",{fileName:t.fileName,fileSize:t.fileSize,pageCount:t.pageCount,extractionTimestamp:t.extractionTimestamp}),console.log("\u{1F4C8} \uBCA1\uD130 \uD1B5\uACC4:",t.summary),console.log("\u{1F50D} \uB514\uBC84\uADF8 \uC815\uBCF4:",t.debugInfo),console.log("\u{1F3A8} \uC804\uCCB4 \uBCA1\uD130 JSON \uB370\uC774\uD130:",t),console.groupEnd()}getOpName(t){return{1:"moveTo",2:"lineTo",3:"curveTo",4:"quadraticCurveTo",5:"bezierCurveTo",6:"arcTo",7:"rectangle",9:"closePath",10:"setLineWidth",11:"setLineCap",12:"setLineJoin",20:"stroke",22:"fill",29:"clip",31:"concat",32:"scale",33:"rotate",34:"translate"}[t]||null}extractCoordinates(t){if(!t||!Array.isArray(t))return null;if(t.length===6&&t.every(n=>typeof n=="number"))return{type:"matrix",x:t[4],y:t[5],transform:[t[0],t[1],t[2],t[3]]};if(t.length===2&&t.every(n=>typeof n=="number"))return{type:"point",x:t[0],y:t[1]};if(t.length===4&&t.every(n=>typeof n=="number"))return{type:"rectangle",x:t[0],y:t[1],width:t[2],height:t[3]};let e=t.filter(n=>typeof n=="number");return e.length>=2?{type:"extracted",x:e[e.length-2],y:e[e.length-1],allNumbers:e}:null}parseSVGPathCommands(t){let e={moveToCount:0,lineToCount:0,curveToCount:0,commands:[]};if(!t||typeof t!="string")return e;let n=/([MLHVCSQTAZmlhvcsqtaz])([^MLHVCSQTAZmlhvcsqtaz]*)/g,o;for(;(o=n.exec(t))!==null;){let r=o[1],i=o[2].trim();if(!i){(r==="Z"||r==="z")&&e.commands.push({type:"closePath",coords:[]});continue}let a=i.replace(/,/g," ").replace(/-/g," -").split(/\s+/).filter(g=>g&&g!=="-").map(g=>parseFloat(g)).filter(g=>!isNaN(g));switch(r.toUpperCase()){case"M":e.moveToCount++,e.commands.push({type:"moveTo",coords:a});break;case"L":e.lineToCount++,e.commands.push({type:"lineTo",coords:a});break;case"H":e.lineToCount++,e.commands.push({type:"hLineTo",coords:a});break;case"V":e.lineToCount++,e.commands.push({type:"vLineTo",coords:a});break;case"C":e.curveToCount++,e.commands.push({type:"curveTo",coords:a});break;case"S":e.curveToCount++,e.commands.push({type:"smoothCurveTo",coords:a});break;case"Q":e.curveToCount++,e.commands.push({type:"quadraticCurveTo",coords:a});break;case"T":e.curveToCount++,e.commands.push({type:"smoothQuadraticCurveTo",coords:a});break;case"A":e.curveToCount++,e.commands.push({type:"arc",coords:a});break;case"Z":e.commands.push({type:"closePath",coords:[]});break}}return e}analyzeSVGPaths(t){let e={totalPaths:0,totalLines:0,totalCurves:0,totalFills:0,pathDetails:[],renderablePaths:[]};return t.querySelectorAll("path").forEach((o,r)=>{let i=o.getAttribute("d");if(!i)return;let a=this.parseSVGPathCommands(i);e.totalPaths+=a.moveToCount,e.totalLines+=a.lineToCount,e.totalCurves+=a.curveToCount;let g=o.getAttribute("fill"),c=o.getAttribute("stroke"),u=g&&g.toLowerCase()!=="none",s=c&&c.toLowerCase()!=="none";(u||s)&&(u&&e.totalFills++,e.renderablePaths.push({element:o,d:i,fill:g,stroke:c,strokeWidth:o.getAttribute("stroke-width"),opacity:o.getAttribute("opacity"),transform:o.getAttribute("transform")})),e.pathDetails.push({pathIndex:r,moveToCount:a.moveToCount,lineToCount:a.lineToCount,curveToCount:a.curveToCount,dAttribute:i.substring(0,100)+(i.length>100?"...":"")})}),e}extractVectorGraphicsFromSVG(t,e){return k(this,null,function*(){try{let n=t.getViewport({scale:1}),o=yield t.getOperatorList({intent:"display"}),i=yield new e.SVGGraphics(t.commonObjs,t.objs).getSVG(o,n),a=this.analyzeSVGPaths(i),c=new XMLSerializer().serializeToString(i);return{totalPaths:a.totalPaths,totalLines:a.totalLines,totalCurves:a.totalCurves,totalFills:a.totalFills,svgString:c.substring(0,500),renderablePaths:a.renderablePaths}}catch(n){return console.error("\u274C SVG \uB80C\uB354\uB9C1 \uC911 \uC624\uB958:",n),{totalPaths:0,totalLines:0,totalCurves:0,totalFills:0,svgString:"",renderablePaths:[]}}})}redrawVectorGraphicsFromSVG(t,e,n){return k(this,null,function*(){try{console.log("\u{1F3A8} SVG \uBCA1\uD130 \uADF8\uB798\uD53D \uC0C8\uB85C\uADF8\uB9AC\uAE30 \uC2DC\uC791...");let o=n.querySelector("canvas");if(!o)return console.error("\u274C \uCE94\uBC84\uC2A4\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),{success:!1,totalElementsCreated:0,fillCount:0,strokeCount:0};let r=o.width,i=o.height,a=o.offsetWidth,g=o.offsetHeight;console.log(`\u{1F4D0} \uCE94\uBC84\uC2A4 \uD06C\uAE30: ${r} x ${i}`),console.log(`\u{1F4D0} \uD45C\uC2DC \uD06C\uAE30: ${a} x ${g}`);let c=t.getViewport({scale:1}),u=r/c.width;console.log(`\u{1F4CF} PDF \uC6D0\uBCF8 \uD06C\uAE30: ${c.width} x ${c.height}`),console.log(`\u{1F50D} \uD604\uC7AC \uC2A4\uCF00\uC77C: ${u}`);let s=t.getViewport({scale:u}),l=yield t.getOperatorList({intent:"display"}),_=yield new e.SVGGraphics(t.commonObjs,t.objs).getSVG(l,s);console.log("\u{1F50D} \uC0DD\uC131\uB41C SVG \uC804\uCCB4 \uAD6C\uC870:"),console.log("SVG \uD06C\uAE30:",s.width,"x",s.height),console.log("SVG \uC790\uC2DD \uC694\uC18C \uAC1C\uC218:",_.children.length),Array.from(_.children).forEach((b,O)=>{let v=b;if(console.log(`
\u{1F4E6} \uC694\uC18C ${O+1}:`,v.tagName),v.tagName==="path"){let w=v;console.log("  - d:",w.getAttribute("d")?.substring(0,100)+"..."),console.log("  - fill:",w.getAttribute("fill")),console.log("  - stroke:",w.getAttribute("stroke")),console.log("  - transform:",w.getAttribute("transform"))}else v.tagName==="g"&&(console.log("  - transform:",v.getAttribute("transform")),console.log("  - \uC790\uC2DD \uAC1C\uC218:",v.children.length),Array.from(v.children).forEach((w,D)=>{let F=w;if(F.tagName==="path"){let N=F;console.log(`    \u2022 path ${D+1}:`),console.log("      - d:",N.getAttribute("d")?.substring(0,80)+"..."),console.log("      - fill:",N.getAttribute("fill")),console.log("      - stroke:",N.getAttribute("stroke"))}}))});let y=this.analyzeSVGPaths(_);if(y.renderablePaths.length===0)return console.warn("\u26A0\uFE0F \uB80C\uB354\uB9C1 \uAC00\uB2A5\uD55C \uBCA1\uD130 \uC694\uC18C\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."),{success:!1,totalElementsCreated:0,fillCount:0,strokeCount:0};console.log(`
\u{1F4CA} \uB80C\uB354\uB9C1 \uAC00\uB2A5\uD55C \uBCA1\uD130 \uC694\uC18C: ${y.renderablePaths.length}\uAC1C`),console.log(`   - fill \uC694\uC18C: ${y.totalFills}\uAC1C`);let d=n.querySelector(".vector-graphics-overlay");d?(d.innerHTML="",d.style.width=`${a}px`,d.style.height=`${g}px`,d.setAttribute("viewBox",`0 0 ${s.width} ${s.height}`)):(d=document.createElementNS("http://www.w3.org/2000/svg","svg"),d.classList.add("vector-graphics-overlay"),d.style.position="absolute",d.style.top="0",d.style.left="0",d.style.width=`${a}px`,d.style.height=`${g}px`,d.style.pointerEvents="none",d.style.zIndex="10",d.setAttribute("viewBox",`0 0 ${s.width} ${s.height}`),d.setAttribute("preserveAspectRatio","xMidYMid meet"),n.style.position="relative",n.appendChild(d));let p=0,m=0;return y.renderablePaths.forEach((b,O)=>{try{let v=document.createElementNS("http://www.w3.org/2000/svg","path");v.setAttribute("d",b.d),b.fill&&(v.setAttribute("fill",b.fill),p++),b.stroke&&(v.setAttribute("stroke",b.stroke),m++),b.strokeWidth&&v.setAttribute("stroke-width",b.strokeWidth),b.opacity&&v.setAttribute("opacity",b.opacity),b.transform&&v.setAttribute("transform",b.transform),v.classList.add("vector-path"),v.setAttribute("data-path-index",O.toString()),d.appendChild(v)}catch(v){console.error(`\u274C Path ${O} \uC0DD\uC131 \uC2E4\uD328:`,v)}}),console.log(`\u2705 \uBCA1\uD130 \uC694\uC18C \uC0DD\uC131 \uC644\uB8CC: ${y.renderablePaths.length}\uAC1C`),console.log(`   - fill: ${p}\uAC1C, stroke: ${m}\uAC1C`),{success:!0,totalElementsCreated:y.renderablePaths.length,fillCount:p,strokeCount:m}}catch(o){return console.error("\u274C \uBCA1\uD130 \uADF8\uB798\uD53D \uC0C8\uB85C\uADF8\uB9AC\uAE30 \uC2E4\uD328:",o),{success:!1,totalElementsCreated:0,fillCount:0,strokeCount:0}}})}redrawAllPagesVectorGraphics(t,e,n){return k(this,null,function*(){try{console.log("\u{1F3A8}\u{1F3A8}\u{1F3A8} \uC804\uCCB4 \uD398\uC774\uC9C0 \uBCA1\uD130 \uADF8\uB798\uD53D \uC0C8\uB85C\uADF8\uB9AC\uAE30 \uC2DC\uC791...");let o=t.numPages,r=0,i=0,a=0;for(let g=1;g<=o;g++){let c=yield t.getPage(g),u=n.querySelector(`.page[data-page-number="${g}"]`);if(!u){console.warn(`\u26A0\uFE0F \uD398\uC774\uC9C0 ${g} DOM \uC694\uC18C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.`);continue}let s=yield this.redrawVectorGraphicsFromSVG(c,e,u);s.success&&(r+=s.totalElementsCreated,i+=s.fillCount,a+=s.strokeCount)}console.log("\u2705\u2705\u2705 \uC804\uCCB4 \uD398\uC774\uC9C0 \uBCA1\uD130 \uADF8\uB798\uD53D \uC0C8\uB85C\uADF8\uB9AC\uAE30 \uC644\uB8CC!"),console.log(`\u{1F4CA} \uCD1D \uC0DD\uC131\uB41C \uC694\uC18C: ${r}\uAC1C`),console.log(`   - fill: ${i}\uAC1C`),console.log(`   - stroke: ${a}\uAC1C`)}catch(o){throw console.error("\u274C \uC804\uCCB4 \uD398\uC774\uC9C0 \uBCA1\uD130 \uADF8\uB798\uD53D \uC0C8\uB85C\uADF8\uB9AC\uAE30 \uC2E4\uD328:",o),o}})}viewVectorGraphicsAsSVG(t,e,n){return k(this,null,function*(){try{console.log(`\u{1F5BC}\uFE0F \uD398\uC774\uC9C0 ${n} \uBCA1\uD130 \uADF8\uB798\uD53D SVG \uC0DD\uC131 \uC911...`);let o=t.getViewport({scale:2}),r=o.width,i=o.height,a=yield t.getOperatorList({intent:"display"}),c=yield new e.SVGGraphics(t.commonObjs,t.objs).getSVG(a,o),s=new XMLSerializer().serializeToString(c);s.includes("viewBox")||(s=s.replace("<svg",`<svg viewBox="0 0 ${r} ${i}"`));let l=`
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>\uD398\uC774\uC9C0 ${n} - \uBCA1\uD130 \uADF8\uB798\uD53D</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .header h1 {
            font-size: 24px;
            color: #333;
            margin-bottom: 10px;
        }
        .info {
            color: #666;
            font-size: 14px;
        }
        .info-item {
            display: inline-block;
            margin-right: 20px;
            margin-bottom: 5px;
        }
        .svg-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: auto;
        }
        svg {
            max-width: 100%;
            height: auto;
            border: 1px solid #ddd;
        }
        .controls {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
        }
        button:hover {
            background: #0056b3;
        }
        button.secondary {
            background: #6c757d;
        }
        button.secondary:hover {
            background: #545b62;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>\u{1F4CA} PDF \uBCA1\uD130 \uADF8\uB798\uD53D - \uD398\uC774\uC9C0 ${n}</h1>
        <div class="info">
            <span class="info-item">\u{1F4D0} \uD06C\uAE30: ${r.toFixed(2)} \xD7 ${i.toFixed(2)}</span>
            <span class="info-item">\u{1F50D} \uC2A4\uCF00\uC77C: 2.0x</span>
            <span class="info-item">\u{1F4C5} \uC0DD\uC131: ${new Date().toLocaleString("ko-KR")}</span>
        </div>
    </div>

    <div class="controls">
        <button onclick="downloadSVG()">\u{1F4BE} SVG \uB2E4\uC6B4\uB85C\uB4DC</button>
        <button onclick="copyToClipboard()" class="secondary">\u{1F4CB} SVG \uCF54\uB4DC \uBCF5\uC0AC</button>
        <button onclick="toggleGrid()" class="secondary">\u{1F4CF} \uADF8\uB9AC\uB4DC \uD1A0\uAE00</button>
    </div>

    <div class="svg-container" id="svgContainer">
        ${s}
    </div>

    <script>
        function downloadSVG() {
            const svgElement = document.querySelector('svg');
            const serializer = new XMLSerializer();
            const svgString = serializer.serializeToString(svgElement);
            const blob = new Blob([svgString], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'page_${n}_vector_graphics.svg';
            a.click();
            URL.revokeObjectURL(url);
        }

        function copyToClipboard() {
            const svgElement = document.querySelector('svg');
            const serializer = new XMLSerializer();
            const svgString = serializer.serializeToString(svgElement);
            navigator.clipboard.writeText(svgString).then(() => {
                console.log('\u2705 SVG \uCF54\uB4DC\uAC00 \uD074\uB9BD\uBCF4\uB4DC\uC5D0 \uBCF5\uC0AC\uB418\uC5C8\uC2B5\uB2C8\uB2E4!');
            }).catch(err => {
                console.error('\uBCF5\uC0AC \uC2E4\uD328:', err);
            });
        }

        let gridVisible = false;
        function toggleGrid() {
            const container = document.getElementById('svgContainer');
            if (gridVisible) {
                container.style.backgroundImage = 'none';
                gridVisible = false;
            } else {
                container.style.backgroundImage = 
                    'linear-gradient(rgba(0,0,0,.1) 1px, transparent 1px),' +
                    'linear-gradient(90deg, rgba(0,0,0,.1) 1px, transparent 1px)';
                container.style.backgroundSize = '20px 20px';
                gridVisible = true;
            }
        }
    <\/script>
</body>
</html>
      `,x=window.open("","_blank");x?(x.document.write(l),x.document.close(),console.log("\u2705 SVG \uBCA1\uD130 \uADF8\uB798\uD53D\uC774 \uC0C8 \uCC3D\uC5D0 \uD45C\uC2DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4!")):console.error("\u274C \uD31D\uC5C5\uC774 \uCC28\uB2E8\uB418\uC5C8\uC2B5\uB2C8\uB2E4. \uD31D\uC5C5 \uD5C8\uC6A9 \uD6C4 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.")}catch(o){throw console.error("\u274C SVG \uC0DD\uC131 \uC2E4\uD328:",o),o}})}downloadAllPagesVectorGraphicsAsSVG(t,e){return k(this,null,function*(){try{console.log("\u{1F4E6} \uBAA8\uB4E0 \uD398\uC774\uC9C0\uC758 \uBCA1\uD130 \uADF8\uB798\uD53D SVG \uC0DD\uC131 \uC911...");let n=t.numPages,o="";for(let c=1;c<=n;c++){let u=yield t.getPage(c),s=u.getViewport({scale:2}),l=yield u.getOperatorList({intent:"display"}),_=yield new e.SVGGraphics(u.commonObjs,u.objs).getSVG(l,s),d=new XMLSerializer().serializeToString(_);o+=`
<!-- \uD398\uC774\uC9C0 ${c} -->
${d}
`}let r=`
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>\uC804\uCCB4 \uD398\uC774\uC9C0 \uBCA1\uD130 \uADF8\uB798\uD53D</title>
    <style>
        body { margin: 20px; background: #f5f5f5; }
        .page { background: white; margin-bottom: 40px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        h2 { margin: 0 0 20px 0; color: #333; }
        svg { max-width: 100%; border: 1px solid #ddd; }
    </style>
</head>
<body>
    <h1>\u{1F4DA} PDF \uBCA1\uD130 \uADF8\uB798\uD53D (\uC804\uCCB4 ${n}\uD398\uC774\uC9C0)</h1>
    ${o}
</body>
</html>
      `,i=new Blob([r],{type:"text/html"}),a=URL.createObjectURL(i),g=document.createElement("a");g.href=a,g.download=`all_pages_vector_graphics_${Date.now()}.html`,g.click(),URL.revokeObjectURL(a),console.log("\u2705 \uBAA8\uB4E0 \uD398\uC774\uC9C0\uC758 \uBCA1\uD130 \uADF8\uB798\uD53D\uC774 \uB2E4\uC6B4\uB85C\uB4DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4!")}catch(n){throw console.error("\u274C \uC804\uCCB4 \uD398\uC774\uC9C0 SVG \uB2E4\uC6B4\uB85C\uB4DC \uC2E4\uD328:",n),n}})}static \u0275fac=function(e){return new(e||h)};static \u0275prov=G({token:h,factory:h.\u0275fac,providedIn:"root"})};var dt=class h{constructor(){}deletePages(t,e){return k(this,null,function*(){try{let o=yield(yield fetch(t)).arrayBuffer(),r=yield PDFLib.PDFDocument.load(o),i=r.getPageCount();console.log(`\uC6D0\uBCF8 PDF \uD398\uC774\uC9C0 \uC218: ${i}`),console.log(`\uC0AD\uC81C\uD560 \uD398\uC774\uC9C0: ${e.join(", ")}`);let a=[...e].sort((s,l)=>l-s);for(let s of a)if(s<1||s>i)throw new Error(`\uD398\uC774\uC9C0 ${s}\uB294 \uC720\uD6A8\uD558\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4. (\uCD1D ${i}\uD398\uC774\uC9C0)`);for(let s of a){let l=s-1;r.removePage(l),console.log(`\uD398\uC774\uC9C0 ${s} \uC0AD\uC81C \uC644\uB8CC`)}let g=yield r.save(),c=new Blob([g],{type:"application/pdf"}),u=URL.createObjectURL(c);return console.log(`\uD398\uC774\uC9C0 \uC0AD\uC81C \uC644\uB8CC. \uB0A8\uC740 \uD398\uC774\uC9C0 \uC218: ${r.getPageCount()}`),u}catch(n){throw console.error("PDF \uD398\uC774\uC9C0 \uC0AD\uC81C \uC911 \uC624\uB958 \uBC1C\uC0DD:",n),n}})}getPageCount(t){return k(this,null,function*(){try{let n=yield(yield fetch(t)).arrayBuffer();return(yield PDFLib.PDFDocument.load(n)).getPageCount()}catch(e){throw console.error("PDF \uD398\uC774\uC9C0 \uC218 \uD655\uC778 \uC911 \uC624\uB958 \uBC1C\uC0DD:",e),e}})}static \u0275fac=function(e){return new(e||h)};static \u0275prov=G({token:h,factory:h.\u0275fac,providedIn:"root"})};var ut=class h{textEditorsSubject=new W([]);activeEditorIdSubject=new W(null);textEditors$=this.textEditorsSubject.asObservable();activeEditorId$=this.activeEditorIdSubject.asObservable();idCounter=0;constructor(){}createTextEditor(t=100,e=100){let n=`text-editor-${++this.idCounter}`,o={id:n,x:t,y:e,width:200,height:100,rotation:0,text:""},r=this.textEditorsSubject.value;return this.textEditorsSubject.next([...r,o]),this.setActiveEditor(n),n}addTextEditor(t){let e=this.textEditorsSubject.value;this.textEditorsSubject.next([...e,t])}updateTextEditor(t,e){let o=this.textEditorsSubject.value.map(r=>r.id===t?U(U({},r),e):r);this.textEditorsSubject.next(o)}deleteTextEditor(t){let n=this.textEditorsSubject.value.filter(o=>o.id!==t);this.textEditorsSubject.next(n),this.activeEditorIdSubject.value===t&&this.setActiveEditor(null)}setActiveEditor(t){this.activeEditorIdSubject.next(t)}getActiveEditor(){return this.activeEditorIdSubject.value}getTextEditor(t){return this.textEditorsSubject.value.find(e=>e.id===t)}getAllTextEditors(){return this.textEditorsSubject.value}getAllActiveEditors(){return this.textEditorsSubject.value}clearAllTextEditors(){this.textEditorsSubject.next([]),this.setActiveEditor(null)}exportTextEditors(){return JSON.stringify(this.textEditorsSubject.value,null,2)}importTextEditors(t){try{let e=JSON.parse(t);return Array.isArray(e)?(this.textEditorsSubject.next(e),this.setActiveEditor(null),!0):!1}catch(e){return console.error("Failed to import text editors:",e),!1}}static \u0275fac=function(e){return new(e||h)};static \u0275prov=G({token:h,factory:h.\u0275fac,providedIn:"root"})};var H=class h{constructor(t){this.cdr=t}textEditor;position={x:0,y:0};cssClass="";fontSizeChange=new V;fontFamilyChange=new V;boldToggle=new V;italicToggle=new V;underlineToggle=new V;textAlignChange=new V;colorChange=new V;ngOnInit(){console.log("PdfTextEditorToolbarComponent ngOnInit")}ngOnChanges(t){console.log("PdfTextEditorToolbarComponent ngOnChanges:",t),t.textEditor&&(console.log("textEditor changed:",t.textEditor.currentValue),this.cdr.detectChanges()),t.position&&console.log("position changed:",t.position.currentValue)}onFontSizeChange(t){let e=t.target,n=parseInt(e.value,10);this.fontSizeChange.emit({editor:this.textEditor,fontSize:n})}onFontFamilyChange(t){let n=t.target.value;this.fontFamilyChange.emit({editor:this.textEditor,fontFamily:n})}onBoldToggle(){this.boldToggle.emit(this.textEditor)}onItalicToggle(){this.italicToggle.emit(this.textEditor)}onUnderlineToggle(){this.underlineToggle.emit(this.textEditor)}onTextAlignChange(t){this.textAlignChange.emit({editor:this.textEditor,align:t})}onColorChange(t){let n=t.target.value;this.colorChange.emit({editor:this.textEditor,color:n})}static \u0275fac=function(e){return new(e||h)(Q(et))};static \u0275cmp=R({type:h,selectors:[["app-pdf-text-adder-toolbar"]],inputs:{textEditor:"textEditor",position:"position",cssClass:"cssClass"},outputs:{fontSizeChange:"fontSizeChange",fontFamilyChange:"fontFamilyChange",boldToggle:"boldToggle",italicToggle:"italicToggle",underlineToggle:"underlineToggle",textAlignChange:"textAlignChange",colorChange:"colorChange"},standalone:!1,features:[j],decls:50,vars:20,consts:[[1,"text-style-toolbar",3,"ngClass"],[1,"toolbar-group"],["type","number","min","8","max","72","step","1",3,"change","value"],[3,"change","value"],["value","Arial"],["value","Helvetica"],["value","Times New Roman"],["value","Courier New"],["value","Georgia"],["value","Verdana"],["value","NanumGothicLocal"],["value","'Pretendard Variable', 'Pretendard'"],["value","'Noto Sans KR'"],["value","'Pretendard Variable', 'Pretendard', 'Noto Sans KR', 'NanumGothicLocal', 'NanumGothic', '\uB098\uB214\uACE0\uB515', sans-serif"],["title","\uAD75\uAC8C",3,"click"],["title","\uAE30\uC6B8\uC784",3,"click"],["title","\uBC11\uC904",3,"click"],["title","\uC67C\uCABD \uC815\uB82C",3,"click"],["title","\uAC00\uC6B4\uB370 \uC815\uB82C",3,"click"],["title","\uC624\uB978\uCABD \uC815\uB82C",3,"click"],["type","color",3,"change","value"]],template:function(e,n){e&1&&(f(0,"div",0)(1,"div",1)(2,"label"),P(3,"\uD06C\uAE30:"),C(),f(4,"input",2),T("change",function(r){return n.onFontSizeChange(r)}),C()(),f(5,"div",1)(6,"label"),P(7,"\uD3F0\uD2B8:"),C(),f(8,"select",3),T("change",function(r){return n.onFontFamilyChange(r)}),f(9,"option",4),P(10,"Arial"),C(),f(11,"option",5),P(12,"Helvetica"),C(),f(13,"option",6),P(14,"Times New Roman"),C(),f(15,"option",7),P(16,"Courier New"),C(),f(17,"option",8),P(18,"Georgia"),C(),f(19,"option",9),P(20,"Verdana"),C(),f(21,"option",10),P(22,"\uB098\uB214\uACE0\uB515"),C(),f(23,"option",11),P(24,"Pretendard"),C(),f(25,"option",12),P(26,"Noto Sans KR"),C(),f(27,"option",13),P(28,"\uAE30\uBCF8 \uD55C\uAE00\uD3F0\uD2B8"),C()()(),f(29,"div",1)(30,"button",14),T("click",function(){return n.onBoldToggle()}),f(31,"strong"),P(32,"B"),C()(),f(33,"button",15),T("click",function(){return n.onItalicToggle()}),f(34,"em"),P(35,"I"),C()(),f(36,"button",16),T("click",function(){return n.onUnderlineToggle()}),f(37,"u"),P(38,"U"),C()()(),f(39,"div",1)(40,"button",17),T("click",function(){return n.onTextAlignChange("left")}),P(41," \u2261 "),C(),f(42,"button",18),T("click",function(){return n.onTextAlignChange("center")}),P(43," \u2261 "),C(),f(44,"button",19),T("click",function(){return n.onTextAlignChange("right")}),P(45," \u2261 "),C()(),f(46,"div",1)(47,"label"),P(48,"\uC0C9\uC0C1:"),C(),f(49,"input",20),T("change",function(r){return n.onColorChange(r)}),C()()()),e&2&&(B("left",n.position.x,"px")("top",n.position.y,"px"),z("ngClass",n.cssClass),S(4),z("value",n.textEditor.fontSize),S(4),z("value",n.textEditor.fontFamily),S(22),L("active",n.textEditor.bold),S(3),L("active",n.textEditor.italic),S(3),L("active",n.textEditor.underline),S(4),L("active",n.textEditor.textAlign==="left"),S(2),L("active",n.textEditor.textAlign==="center"),S(2),L("active",n.textEditor.textAlign==="right"),S(5),z("value",n.textEditor.color))},dependencies:[nt,at,st],styles:['@charset "UTF-8";.text-style-toolbar[_ngcontent-%COMP%]{position:absolute;background:#fff;border:1px solid #ddd;border-radius:4px;padding:8px;display:flex;gap:12px;align-items:center;box-shadow:0 2px 8px #00000026;z-index:1001;font-size:12px;white-space:nowrap}.text-style-toolbar[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.text-style-toolbar[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;color:#666;white-space:nowrap}.text-style-toolbar[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{width:50px;padding:2px 4px;border:1px solid #ddd;border-radius:2px;font-size:12px}.text-style-toolbar[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:2px 4px;border:1px solid #ddd;border-radius:2px;font-size:12px;min-width:80px;background:#fff}.text-style-toolbar[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   input[type=color][_ngcontent-%COMP%]{width:30px;height:24px;border:1px solid #ddd;border-radius:2px;cursor:pointer;padding:0}.text-style-toolbar[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:4px 8px;border:1px solid #ddd;background:#fff;border-radius:2px;cursor:pointer;font-size:12px;min-width:24px}.text-style-toolbar[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f5f5f5}.text-style-toolbar[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#007acc;color:#fff;border-color:#007acc}.text-style-toolbar.inline[_ngcontent-%COMP%]{position:relative;border-radius:4px 4px 0 0;box-shadow:0 -2px 8px #0000001a;padding:6px 8px;gap:8px;font-size:11px}.text-style-toolbar.inline[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]{gap:3px}.text-style-toolbar.inline[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:11px}.text-style-toolbar.inline[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{width:45px;font-size:11px}.text-style-toolbar.inline[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:11px;min-width:70px}.text-style-toolbar.inline[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   input[type=color][_ngcontent-%COMP%]{width:24px;height:20px}.text-style-toolbar.inline[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:3px 6px;font-size:10px;min-width:20px}.text-style-toolbar.floating[_ngcontent-%COMP%]{position:fixed;z-index:2000;box-shadow:0 4px 12px #0003}.text-style-toolbar.modifier[_ngcontent-%COMP%]{position:absolute;z-index:1500;box-shadow:0 4px 12px #0003}.text-style-toolbar.compact[_ngcontent-%COMP%]{padding:4px 6px;gap:6px;font-size:11px}.text-style-toolbar.compact[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]{gap:2px}.toolbar-group[_ngcontent-%COMP%]   button[title*=\\c815\\b82c][_ngcontent-%COMP%]{position:relative}.toolbar-group[_ngcontent-%COMP%]   button[title*=\\c815\\b82c][title*=\\c67c\\cabd][_ngcontent-%COMP%]{text-align:left}.toolbar-group[_ngcontent-%COMP%]   button[title*=\\c815\\b82c][title*=\\ac00\\c6b4\\b370][_ngcontent-%COMP%]{text-align:center}.toolbar-group[_ngcontent-%COMP%]   button[title*=\\c815\\b82c][title*=\\c624\\b978\\cabd][_ngcontent-%COMP%]{text-align:right}']})};var xt=["textEditor"],Ct=["textarea"];function yt(h,t){if(h&1){let e=$();f(0,"div",16),T("mousedown",function(o){E(e);let r=A();return M(r.startResize(o,"nw"))}),C()}}function vt(h,t){if(h&1){let e=$();f(0,"div",17),T("mousedown",function(o){E(e);let r=A();return M(r.startResize(o,"ne"))}),C()}}function _t(h,t){if(h&1){let e=$();f(0,"div",18),T("mousedown",function(o){E(e);let r=A();return M(r.startResize(o,"sw"))}),C()}}function wt(h,t){if(h&1){let e=$();f(0,"div",19),T("mousedown",function(o){E(e);let r=A();return M(r.startResize(o,"se"))}),C()}}function Tt(h,t){if(h&1){let e=$();f(0,"div",20),T("mousedown",function(o){E(e);let r=A();return M(r.startResize(o,"n"))}),C()}}function Pt(h,t){if(h&1){let e=$();f(0,"div",21),T("mousedown",function(o){E(e);let r=A();return M(r.startResize(o,"s"))}),C()}}function St(h,t){if(h&1){let e=$();f(0,"div",22),T("mousedown",function(o){E(e);let r=A();return M(r.startResize(o,"w"))}),C()}}function Et(h,t){if(h&1){let e=$();f(0,"div",23),T("mousedown",function(o){E(e);let r=A();return M(r.startResize(o,"e"))}),C()}}function Mt(h,t){if(h&1){let e=$();f(0,"app-pdf-text-adder-toolbar",24),T("fontSizeChange",function(o){E(e);let r=A();return M(r.onToolbarFontSizeChange(o))})("fontFamilyChange",function(o){E(e);let r=A();return M(r.onToolbarFontFamilyChange(o))})("boldToggle",function(o){E(e);let r=A();return M(r.onToolbarBoldToggle(o))})("italicToggle",function(o){E(e);let r=A();return M(r.onToolbarItalicToggle(o))})("underlineToggle",function(o){E(e);let r=A();return M(r.onToolbarUnderlineToggle(o))})("textAlignChange",function(o){E(e);let r=A();return M(r.onToolbarTextAlignChange(o))})("colorChange",function(o){E(e);let r=A();return M(r.onToolbarColorChange(o))}),C()}if(h&2){let e=A();z("textEditor",e.convertToTextEditor())("position",e.toolbarPosition)}}var pt=class h{config={id:"",x:100,y:100,width:200,height:100,rotation:0,text:"",font:{name:"Arial",size:14}};isVisible=!1;containerWidth=800;containerHeight=600;configChange=new V;close=new V;delete=new V;deactivate=new V;textEditor;textarea;toolbarPosition={x:0,y:0};showToolbar=!1;isDragging=!1;isResizing=!1;isRotating=!1;dragStart={x:0,y:0};resizeHandle="";initialRotation=0;initialAngle=0;resizeObserver;ngOnInit(){this.config.id||(this.config.id="text-editor-"+Date.now()),this.resizeObserver=new ResizeObserver(()=>{this.constrainPosition()})}ngOnChanges(t){if(t.config&&t.config.currentValue){let e=t.config.currentValue;e.isActive!==void 0&&(console.log(`\uD14D\uC2A4\uD2B8 \uC5D0\uB514\uD130 ${e.id} \uD65C\uC131\uD654 \uC0C1\uD0DC \uBCC0\uACBD:`,e.isActive),e.isActive?this.showToolbarForEditor():this.showToolbar=!1)}}ngOnDestroy(){this.resizeObserver?.disconnect()}ngAfterViewInit(){this.textarea&&this.config.text&&setTimeout(()=>{this.autoResizeTextarea(this.textarea.nativeElement)},0)}onMouseDown(t){t.preventDefault(),t.stopPropagation();let e=t.target;e.tagName!=="TEXTAREA"&&(e.classList.contains("resize-handle")?this.startResize(t,e.dataset.handle||""):e.classList.contains("rotate-handle")?this.startRotate(t):this.startDrag(t))}startDrag(t){t.preventDefault(),t.stopPropagation(),this.isDragging=!0,this.dragStart={x:t.clientX-this.config.x,y:t.clientY-this.config.y},document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}startResize(t,e){t.preventDefault(),t.stopPropagation(),this.isResizing=!0,this.resizeHandle=e,this.dragStart={x:t.clientX,y:t.clientY},document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}startRotate(t){t.preventDefault(),t.stopPropagation(),this.isRotating=!0,this.initialRotation=this.config.rotation;let e=this.textEditor.nativeElement.getBoundingClientRect(),n=e.left+e.width/2,o=e.top+e.height/2;this.initialAngle=Math.atan2(t.clientY-o,t.clientX-n)*180/Math.PI,document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),document.body.style.cursor="grabbing"}onMouseMove=t=>{this.isDragging?(this.config.x=t.clientX-this.dragStart.x,this.config.y=t.clientY-this.dragStart.y,this.constrainPosition()):this.isResizing?this.handleResize(t):this.isRotating&&this.handleRotate(t),this.configChange.emit(this.config),this.showToolbar&&this.updateToolbarPosition()};onMouseUp=()=>{this.isDragging=!1,this.isResizing=!1,this.isRotating=!1,this.resizeHandle="",document.body.style.cursor="",document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)};handleResize(t){let e=t.clientX-this.dragStart.x,n=t.clientY-this.dragStart.y;switch(this.resizeHandle){case"nw":this.config.x+=e,this.config.y+=n,this.config.width-=e,this.config.height-=n;break;case"ne":this.config.y+=n,this.config.width+=e,this.config.height-=n;break;case"sw":this.config.x+=e,this.config.width-=e,this.config.height+=n;break;case"se":this.config.width+=e,this.config.height+=n;break;case"n":this.config.y+=n,this.config.height-=n;break;case"s":this.config.height+=n;break;case"w":this.config.x+=e,this.config.width-=e;break;case"e":this.config.width+=e;break}this.config.width=Math.max(50,this.config.width),this.config.height=Math.max(30,this.config.height),this.dragStart={x:t.clientX,y:t.clientY},this.constrainPosition()}handleRotate(t){let e=this.textEditor.nativeElement.getBoundingClientRect(),n=e.left+e.width/2,o=e.top+e.height/2,i=Math.atan2(t.clientY-o,t.clientX-n)*180/Math.PI-this.initialAngle;this.config.rotation=(this.initialRotation+i)%360,this.config.rotation<0&&(this.config.rotation+=360)}constrainPosition(){this.config.x=Math.max(0,Math.min(this.containerWidth-this.config.width,this.config.x)),this.config.y=Math.max(0,Math.min(this.containerHeight-this.config.height,this.config.y))}onTextChange(t){let e=t.target,n=this.config.text;if(this.config.text=e.value,console.log("=== \uD14D\uC2A4\uD2B8 \uC5D0\uB514\uD130 \uBCC0\uACBD \uAC10\uC9C0 ==="),console.log("\uC5D0\uB514\uD130 ID:",this.config.id),console.log("\uC774\uC804 \uD14D\uC2A4\uD2B8:",n),console.log("\uC0C8 \uD14D\uC2A4\uD2B8:",this.config.text),console.log("\uC6D0\uBCF8 \uD14D\uC2A4\uD2B8:",this.config.originalText),this.config.originalText!==void 0){let o=this.config.isModified;this.config.isModified=this.config.text.trim()!==this.config.originalText.trim(),console.log("\uC218\uC815 \uC0C1\uD0DC \uBCC0\uACBD:",o,"\u2192",this.config.isModified),console.log("\uD14D\uC2A4\uD2B8 \uBE44\uAD50:",{current:`"${this.config.text.trim()}"`,original:`"${this.config.originalText.trim()}"`,equal:this.config.text.trim()===this.config.originalText.trim()}),o!==this.config.isModified&&(console.log(`\u{1F504} \uC5D0\uB514\uD130 ${this.config.id} \uC218\uC815 \uC0C1\uD0DC \uBCC0\uACBD: ${o} \u2192 ${this.config.isModified}`),this.config.isModified?console.log(`\u{1F4DD} \uC5D0\uB514\uD130 ${this.config.id}\uAC00 \uC218\uC815\uB428\uC73C\uB85C \uD45C\uC2DC\uB428 (\uC800\uC7A5 \uB300\uC0C1\uC5D0 \uD3EC\uD568\uB428)`):console.log(`\u{1F504} \uC5D0\uB514\uD130 ${this.config.id}\uAC00 \uC6D0\uBCF8\uC73C\uB85C \uB418\uB3CC\uC544\uAC10`))}this.autoResizeTextarea(e),console.log("\uC0C1\uC704 \uCEF4\uD3EC\uB10C\uD2B8\uB85C \uBCC0\uACBD\uC0AC\uD56D \uC804\uB2EC \uC911..."),this.configChange.emit(this.config),console.log("=== \uD14D\uC2A4\uD2B8 \uC5D0\uB514\uD130 \uBCC0\uACBD \uCC98\uB9AC \uC644\uB8CC ===")}autoResizeTextarea(t){let e=t.style.height;t.style.height="auto";let n=this.config.font?.size||14,o=Math.max(n*1.5+16,30),r=t.scrollHeight,i=Math.max(r,o);this.config.height=i,t.style.height=i+"px",this.configChange.emit(this.config)}onTextareaMouseDown(t){t.stopPropagation()}onTextareaClick(t){t.stopPropagation();let e=t.target;if(this.config.isActive)e.focus(),this.showToolbarForEditor();else{let n=new CustomEvent("activate-text-editor",{detail:{editorId:this.config.id}});document.dispatchEvent(n)}}onClose(){this.close.emit()}onDelete(){this.delete.emit(this.config.id)}onDeactivate(){this.deactivate.emit(this.config.id)}focusTextarea(){this.textarea&&this.textarea.nativeElement.focus()}getTransform(){return`translate(${this.config.x}px, ${this.config.y}px) rotate(${this.config.rotation}deg)`}getTextareaStyle(){let t=this.config.font?.name||"Arial",e=this.config.font?.size||14,n=this.config.font?.color||"#000000",o=this.config.font?.weight||"normal",r=this.config.font?.style||"normal",i=this.config.font?.letterSpacing||0,a=this.config.font?.lineHeight||1.2;return{fontSize:`${e}px`,fontFamily:'"Pretendard Variable", "Pretendard", "Noto Sans KR", "NanumGothicLocal", "NanumGothic", "\uB098\uB214\uACE0\uB515", sans-serif',color:n,fontWeight:o,fontStyle:r,letterSpacing:`${i}px`,lineHeight:a,fontKerning:"auto",fontVariantLigatures:"common-ligatures",fontFeatureSettings:'"kern" 1',textSizeAdjust:"100%",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",fontStretch:"semi-condensed",transform:"scaleX(0.97)",wordBreak:"keep-all",overflowWrap:"break-word",backgroundColor:"rgba(255, 255, 255, 0.9)",width:"100%",height:"100%",border:"none",outline:"none",resize:"none",overflow:"hidden",padding:"2px 4px",margin:"0",boxSizing:"border-box"}}isTextModified(){return this.config.originalText?this.config.text.trim()!==this.config.originalText.trim():!1}convertToTextEditor(){return{id:this.config.id,x:this.config.x,y:this.config.y,width:this.config.width,height:this.config.height,text:this.config.text,fontSize:this.config.font?.size||14,fontFamily:this.config.font?.name||"Arial",color:this.config.font?.color||"#000000",bold:this.config.font?.weight==="bold"||this.config.font?.weight==="700",italic:this.config.font?.style==="italic",underline:!1,textAlign:"left",zIndex:1e3}}showToolbarForEditor(){this.config.isActive&&(this.showToolbar=!0,this.updateToolbarPosition())}updateToolbarPosition(){let t=this.containerWidth||800,e=this.containerHeight||600,n=400,o=50,r=this.config.x,i=this.config.y;i=this.config.y-o-10,r+n>t-20&&(r=t-n-20),i<10&&(i=this.config.y+this.config.height+10),i+o>e-20&&(i=e-o-20),r<10&&(r=10),this.toolbarPosition={x:r,y:i}}onToolbarFontSizeChange(t){this.config.font?this.config.font.size=t.fontSize:this.config.font={name:"Arial",size:t.fontSize},this.configChange.emit(this.config)}onToolbarFontFamilyChange(t){this.config.font?this.config.font.name=t.fontFamily:this.config.font={name:t.fontFamily,size:14},this.configChange.emit(this.config)}onToolbarBoldToggle(t){this.config.font?this.config.font.weight=t.bold?"bold":"normal":this.config.font={name:"Arial",size:14,weight:t.bold?"bold":"normal"},this.configChange.emit(this.config)}onToolbarItalicToggle(t){this.config.font?this.config.font.style=t.italic?"italic":"normal":this.config.font={name:"Arial",size:14,style:t.italic?"italic":"normal"},this.configChange.emit(this.config)}onToolbarUnderlineToggle(t){console.log("Underline toggle not supported in TextEditorConfig")}onToolbarTextAlignChange(t){console.log("Text align change not supported in TextEditorConfig")}onToolbarColorChange(t){this.config.font?this.config.font.color=t.color:this.config.font={name:"Arial",size:14,color:t.color},this.configChange.emit(this.config)}static \u0275fac=function(e){return new(e||h)};static \u0275cmp=R({type:h,selectors:[["app-pdf-text-modifier"]],viewQuery:function(e,n){if(e&1&&(q(xt,5),q(Ct,5)),e&2){let o;X(o=J())&&(n.textEditor=o.first),X(o=J())&&(n.textarea=o.first)}},inputs:{config:"config",isVisible:"isVisible",containerWidth:"containerWidth",containerHeight:"containerHeight"},outputs:{configChange:"configChange",close:"close",delete:"delete",deactivate:"deactivate"},standalone:!1,features:[j],decls:17,vars:30,consts:[["textEditor",""],["textarea",""],[1,"text-editor-container"],["title","\uB4DC\uB798\uADF8\uD558\uC5EC \uC774\uB3D9",1,"drag-handle",3,"mousedown"],[1,"drag-indicator"],["placeholder","\uD14D\uC2A4\uD2B8\uB97C \uC785\uB825\uD558\uC138\uC694...",1,"text-input",3,"input","mousedown","click","ngStyle","value","readonly"],[1,"border"],["class","resize-handle nw","data-handle","nw",3,"mousedown",4,"ngIf"],["class","resize-handle ne","data-handle","ne",3,"mousedown",4,"ngIf"],["class","resize-handle sw","data-handle","sw",3,"mousedown",4,"ngIf"],["class","resize-handle se","data-handle","se",3,"mousedown",4,"ngIf"],["class","resize-handle n","data-handle","n",3,"mousedown",4,"ngIf"],["class","resize-handle s","data-handle","s",3,"mousedown",4,"ngIf"],["class","resize-handle w","data-handle","w",3,"mousedown",4,"ngIf"],["class","resize-handle e","data-handle","e",3,"mousedown",4,"ngIf"],["cssClass","modifier",3,"textEditor","position","fontSizeChange","fontFamilyChange","boldToggle","italicToggle","underlineToggle","textAlignChange","colorChange",4,"ngIf"],["data-handle","nw",1,"resize-handle","nw",3,"mousedown"],["data-handle","ne",1,"resize-handle","ne",3,"mousedown"],["data-handle","sw",1,"resize-handle","sw",3,"mousedown"],["data-handle","se",1,"resize-handle","se",3,"mousedown"],["data-handle","n",1,"resize-handle","n",3,"mousedown"],["data-handle","s",1,"resize-handle","s",3,"mousedown"],["data-handle","w",1,"resize-handle","w",3,"mousedown"],["data-handle","e",1,"resize-handle","e",3,"mousedown"],["cssClass","modifier",3,"fontSizeChange","fontFamilyChange","boldToggle","italicToggle","underlineToggle","textAlignChange","colorChange","textEditor","position"]],template:function(e,n){if(e&1){let o=$();f(0,"div",2,0)(2,"div",3),T("mousedown",function(i){return E(o),M(n.startDrag(i))}),f(3,"div",4),P(4,"\u22EE\u22EE"),C()(),f(5,"textarea",5,1),T("input",function(i){return E(o),M(n.onTextChange(i))})("mousedown",function(i){return E(o),M(n.onTextareaMouseDown(i))})("click",function(i){return E(o),M(n.onTextareaClick(i))}),C(),tt(7,"div",6),Y(8,yt,1,0,"div",7)(9,vt,1,0,"div",8)(10,_t,1,0,"div",9)(11,wt,1,0,"div",10)(12,Tt,1,0,"div",11)(13,Pt,1,0,"div",12)(14,St,1,0,"div",13)(15,Et,1,0,"div",14),C(),Y(16,Mt,1,2,"app-pdf-text-adder-toolbar",15)}e&2&&(B("display",n.isVisible?"block":"none")("transform",n.getTransform())("width",n.config.width,"px")("height",n.config.height,"px"),L("dragging",n.isDragging)("resizing",n.isResizing)("rotating",n.isRotating)("text-modified",n.isTextModified())("active-editor",n.config.isActive),S(5),z("ngStyle",n.getTextareaStyle())("value",n.config.text)("readonly",!n.config.isActive),S(3),z("ngIf",n.config.isActive),S(),z("ngIf",n.config.isActive),S(),z("ngIf",n.config.isActive),S(),z("ngIf",n.config.isActive),S(),z("ngIf",n.config.isActive),S(),z("ngIf",n.config.isActive),S(),z("ngIf",n.config.isActive),S(),z("ngIf",n.config.isActive),S(),z("ngIf",n.showToolbar&&n.config.isActive))},dependencies:[ot,it,H],styles:[".text-editor-container[_ngcontent-%COMP%]{position:absolute;min-width:50px;min-height:30px;z-index:1000;-webkit-user-select:none;user-select:none;box-sizing:border-box}.text-editor-container[_ngcontent-%COMP%]:hover   .resize-handle[_ngcontent-%COMP%], .text-editor-container[_ngcontent-%COMP%]:hover   .rotate-handle[_ngcontent-%COMP%], .text-editor-container[_ngcontent-%COMP%]:hover   .control-panel[_ngcontent-%COMP%], .text-editor-container[_ngcontent-%COMP%]:hover   .drag-handle[_ngcontent-%COMP%]{opacity:1}.text-editor-container.text-modified[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border-color:#ffc107;box-shadow:0 0 4px #ffc10780}.text-editor-container[_ngcontent-%COMP%]:not(.active-editor):hover   .resize-handle[_ngcontent-%COMP%], .text-editor-container[_ngcontent-%COMP%]:not(.active-editor):hover   .rotate-handle[_ngcontent-%COMP%], .text-editor-container[_ngcontent-%COMP%]:not(.active-editor):hover   .control-panel[_ngcontent-%COMP%], .text-editor-container[_ngcontent-%COMP%]:not(.active-editor):hover   .drag-handle[_ngcontent-%COMP%]{opacity:0}.drag-handle[_ngcontent-%COMP%]{position:absolute;top:50%;left:-25px;transform:translateY(-50%);width:15px;height:30px;background:#b2b2b2;border:1px solid #fff;border-radius:4px 0 0 4px;display:flex;align-items:center;justify-content:center;cursor:move;opacity:0;transition:opacity .2s ease;z-index:2;color:#fff;font-size:10px}.drag-handle[_ngcontent-%COMP%]   .drag-indicator[_ngcontent-%COMP%]{font-weight:700;line-height:1;transform:rotate(90deg)}.drag-handle[_ngcontent-%COMP%]:hover{background:#323232}.text-input[_ngcontent-%COMP%]{position:absolute;top:0;left:0;border:none;outline:none;resize:none;background:transparent;z-index:1;cursor:text;overflow:hidden;word-wrap:break-word;white-space:pre-wrap}.text-input[readonly][_ngcontent-%COMP%]{cursor:pointer;background-color:#fffc;color:#333}.border[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;box-sizing:border-box;border:2px solid #007ACC}.resize-handle[_ngcontent-%COMP%]{position:absolute;background:#007acc;border:1px solid #fff;opacity:0;transition:opacity .2s ease;z-index:2}.resize-handle.nw[_ngcontent-%COMP%], .resize-handle.ne[_ngcontent-%COMP%], .resize-handle.sw[_ngcontent-%COMP%], .resize-handle.se[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%}.resize-handle.n[_ngcontent-%COMP%], .resize-handle.s[_ngcontent-%COMP%]{width:20px;height:6px;left:50%;transform:translate(-50%)}.resize-handle.w[_ngcontent-%COMP%], .resize-handle.e[_ngcontent-%COMP%]{width:6px;height:20px;top:50%;transform:translateY(-50%)}.resize-handle.nw[_ngcontent-%COMP%]{top:-4px;left:-4px;cursor:nw-resize}.resize-handle.ne[_ngcontent-%COMP%]{top:-4px;right:-4px;cursor:ne-resize}.resize-handle.sw[_ngcontent-%COMP%]{bottom:-4px;left:-4px;cursor:sw-resize}.resize-handle.se[_ngcontent-%COMP%]{bottom:-4px;right:-4px;cursor:se-resize}.resize-handle.n[_ngcontent-%COMP%]{top:-3px;cursor:n-resize}.resize-handle.s[_ngcontent-%COMP%]{bottom:-3px;cursor:s-resize}.resize-handle.w[_ngcontent-%COMP%]{left:-3px;cursor:w-resize}.resize-handle.e[_ngcontent-%COMP%]{right:-3px;cursor:e-resize}.rotate-handle[_ngcontent-%COMP%]{position:absolute;top:-30px;left:50%;transform:translate(-50%);width:24px;height:24px;background:#ffc107;border:1px solid #fff;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:grab;opacity:0;transition:opacity .2s ease;z-index:2;color:#212529}.rotate-handle[_ngcontent-%COMP%]:active{cursor:grabbing}.rotate-handle[_ngcontent-%COMP%]:hover{background:#e0a800}.rotate-handle[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:14px;height:14px}.control-panel[_ngcontent-%COMP%]{position:absolute;bottom:-35px;right:-5px;background:#fffffff2;border:1px solid #ccc;border-radius:4px;padding:4px;opacity:0;transition:opacity .2s ease;z-index:3;box-shadow:0 2px 8px #00000026}.control-panel[_ngcontent-%COMP%]   .control-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:4px}.btn-close[_ngcontent-%COMP%], .btn-delete[_ngcontent-%COMP%], .btn-deactivate[_ngcontent-%COMP%]{width:24px;height:24px;border:none;border-radius:2px;cursor:pointer;font-size:12px;display:flex;align-items:center;justify-content:center}.btn-close[_ngcontent-%COMP%]:hover, .btn-delete[_ngcontent-%COMP%]:hover, .btn-deactivate[_ngcontent-%COMP%]:hover{opacity:.7}.btn-close[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.btn-delete[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn-deactivate[_ngcontent-%COMP%]{background:#ffc107;color:#212529}.text-input[_ngcontent-%COMP%]{line-height:inherit;vertical-align:top;text-align:left;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.text-editor-container.dragging[_ngcontent-%COMP%]   .text-input[_ngcontent-%COMP%], .text-editor-container.resizing[_ngcontent-%COMP%]   .text-input[_ngcontent-%COMP%], .text-editor-container.rotating[_ngcontent-%COMP%]   .text-input[_ngcontent-%COMP%]{pointer-events:none;-webkit-user-select:none;user-select:none}.text-editor-container.dragging[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{opacity:.5;background:#414141;cursor:grabbing}.text-editor-container.rotating[_ngcontent-%COMP%]   .rotate-handle[_ngcontent-%COMP%]{opacity:1;background:#e0a800;cursor:grabbing}.text-editor-container.selected[_ngcontent-%COMP%]   .resize-handle[_ngcontent-%COMP%], .text-editor-container.selected[_ngcontent-%COMP%]   .rotate-handle[_ngcontent-%COMP%], .text-editor-container.selected[_ngcontent-%COMP%]   .control-panel[_ngcontent-%COMP%], .text-editor-container.selected[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{opacity:1}"]})};export{ct as a,gt as b,dt as c,ut as d,H as e,pt as f};
