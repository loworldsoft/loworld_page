{
  "version": 3,
  "sources": ["Modules/pages/chatbot/components/classes/chat-history.rest.ts", "Modules/pages/chatbot/components/classes/chat-history.menu.ts", "Modules/pages/chatflow/components/atom/list/list.component.ts", "Modules/pages/chatflow/components/atom/list/list.component.html"],
  "sourcesContent": ["import { MatSnackBar } from \"@angular/material/snack-bar\";\nimport { MatDialog } from \"@angular/material/dialog\";\nimport { IChatHistoryRequest } from \"../../../../core/http/chat-history.http\";\nimport { ConfirmDialogComponent } from \"../../../../shared/components/molecules/confirm-dialog/confirm-dialog.component\";\nimport { Router } from \"@angular/router\";\nimport { inject } from \"@angular/core\";\nimport { DalService } from \"../../../../core/services/dal.service\";\nimport { DynamicLayoutService } from './../../../../core/services/dynamic-layout.service';\nimport { HistoryService } from \"../../../../core/services/history.service\";\n\nexport class ChatHistoryRest {\n\n  private readonly router = inject(Router);\n  private readonly dialog = inject(MatDialog);\n  private readonly _snackBar = inject(MatSnackBar);\n  private readonly dalService = inject(DalService);\n  private readonly dynamicLayoutService = inject(DynamicLayoutService);\n  private readonly historyService = inject(HistoryService);\n\n  public delete(request: IChatHistoryRequest) {\n    const dialogRef = this.dialog.open(ConfirmDialogComponent, {\n      data: {\n        title: '히스토리 삭제',\n        content: `히스토리를 삭제하시겠습니까?`,\n        btnYes: '예',\n        btnNo: '아니요'\n      }\n    });\n\n    dialogRef.afterClosed().subscribe((d: boolean) => {\n      if (!d) return;\n\n      this.dalService.chatHistoryHttp.delete(request).subscribe(response => {\n        this._snackBar.open('히스토리가 삭제되었습니다.', '확인', {\n          duration: 2000,\n          horizontalPosition: 'center',\n          verticalPosition: 'top'\n        });\n\n        if (request.chatPageId === this.historyService.currentChatPageId) {\n          this.router.navigateByUrl('/chatbot');\n          return;\n        }\n        \n        this.historyService.allhistoryList = JSON.parse(response.data);\n        const groupHistoryList = this.historyService.groupHistoryList();\n        this.dynamicLayoutService.historyListContainer.instance.historyList = groupHistoryList;\n      });\n    });\n  }\n \n}", "import { inject } from \"@angular/core\";\nimport { IMenu, IMenuData } from \"../../../../components/menu-item/menu/menu.interface\";\nimport { ChatHistoryRest } from \"./chat-history.rest\";\n\nexport class ChatHistoryMenuData implements IMenu {\n\n  private readonly restApi = inject(ChatHistoryRest);\n\n  menuData: IMenuData[] = [\n    {\n      itemName: '삭제',\n      icon: 'delete',\n      itemFunc: this.restApi.delete.bind(this.restApi),\n      checkDisabled() {\n        return false;\n      }\n    }\n  ]\n\n}", "import { Component, ViewChild, inject } from '@angular/core';\nimport { DataAbstract } from '../../../../../core/classes/data.abstract';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { IChatHistoryRequest } from '../../../../../core/http/chat-history.http';\nimport { ChatHistoryMenuData } from '../../../../chatbot/components/classes/chat-history.menu';\nimport { MenuComponent } from '../../../../../components/menu-item/menu/menu.component';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ConfirmDialogComponent } from '../../../../../shared/components/molecules/confirm-dialog/confirm-dialog.component';\nimport { MatSnackBar } from '@angular/material/snack-bar';\n\ninterface IHistory {\n  header: string;\n  items: {\n    id: string;\n    message: string;\n    type: string;\n  }[]\n}\n\n@Component({\n  selector: 'app-list',\n  templateUrl: './list.component.html',\n  styleUrl: './list.component.scss'\n})\nexport class ListComponent extends DataAbstract {\n\n  @ViewChild('menu', { static: false }) menuComponent!: MenuComponent;\n\n  public historyList: IHistory[] = [];\n\n  public override dataInit(): void {\n    this.historyList = this.data;\n  }\n\n  public isChecked: boolean = false;\n  public isClicked: boolean = false;\n\n  public historyDeleteData: IChatHistoryRequest = {\n    userIdx: this.currentUser.userData.userIdx,\n    chatPageId: ''\n  };\n\n  private readonly dialog = inject(MatDialog);\n  private readonly router = inject(Router);\n  private readonly route = inject(ActivatedRoute);\n  private readonly _snackBar = inject(MatSnackBar);\n  \n  public historyMenu = new ChatHistoryMenuData();\n  \n  public onClickListItem(pageId: string) {\n    this.historyService.currentChatPageId = pageId;\n\n    this.historyService.allhistoryList = null;\n    this.historyService.pageHistoryList = null;\n    this.historyService.historyMetadata = [];\n\n    this.dalService.chatHistoryHttp.get(this.currentUser.userData.userIdx).subscribe(response => {\n      this.historyService.allhistoryList = JSON.parse(response.data);\n      this.historyService.pageHistoryList = this.historyService.allhistoryList.find((page: any) => page.key === this.historyService.currentChatPageId);\n\n      this.router.navigateByUrl(`/chatbot/${pageId}`);\n      this.globalService.chatflow.scenario('history');\n    });\n  }\n\n  public deleteHistory(event: MouseEvent, id: string) {\n    event.stopPropagation();\n    this.historyDeleteData = {\n      userIdx: this.currentUser.userData.userIdx,\n      chatPageId: id\n    };\n\n    const dialogRef = this.dialog.open(ConfirmDialogComponent, {\n      data: {\n        title: '히스토리 삭제',\n        content: '히스토리를 삭제하시겠습니까?',\n        btnYes: '예',\n        btnNo: '아니요'\n      }\n    });\n\n    dialogRef.afterClosed().subscribe((d: boolean) => {\n      if (!d) return;\n\n      this.dalService.chatHistoryHttp.delete(this.historyDeleteData).subscribe(response => {\n        this._snackBar.open(\"히스토리가 삭제되었습니다\", '확인', {\n          duration: 2000,\n          horizontalPosition: 'center',\n          verticalPosition: 'top'\n        });\n\n        if (this.historyDeleteData.chatPageId === this.historyService.currentChatPageId) {\n          this.router.navigateByUrl('/chatbot');\n          return;\n        }\n\n        this.historyService.allhistoryList = JSON.parse(response.data);\n        const groupHistoryList = this.historyService.groupHistoryList();\n        this.dynamicLayoutService.historyListContainer.instance.historyList = groupHistoryList;\n      })\n    });\n  }\n\n  // TODO: DOM에서 호출하기 떄문에 개선 필요 (중요이슈)\n  public getClicked(id: string) {\n    return id === (this.route.params as any).value.chatPageId;\n  }\n\n}\n", "<mat-list class=\"text-ellipsis\">\n  @for (element of historyList; track $index) {\n    <div mat-subheader style=\"font-weight: 600;\">{{ element.header | todayFormat }}</div>\n    @for (item of element.items; track item) {\n      <mat-list-item \n        [id]=\"item.id\"\n        matRipple  \n        (click)=\"onClickListItem(item.id)\"\n      >\n        <div style=\"display: flex;\">\n          <div matListItemTitle [ngClass]=\"{'checked': isChecked, 'base' : !isChecked, 'clicked' : getClicked(item.id)}\">\n            {{ item.type === 'complain' ? '민원 처리' :  item.message }}\n          </div>\n          <span class=\"example-spacer\"></span>\n          <button mat-icon-button style=\"transform: translate(0px, -6.8px);\" (click)=\"deleteHistory($event, item.id)\">\n            <mat-icon>close</mat-icon>\n          </button>\n        </div>\n      </mat-list-item>\n    }\n  }\n</mat-list>\n"],
  "mappings": "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",
  "names": []
}
