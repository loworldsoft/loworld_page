{
  "version": 3,
  "sources": ["Modules/pages/chatbot/components/chat/chat.component.ts", "Modules/pages/chatbot/components/chat/chat.component.html", "Modules/pages/chatbot/components/chat-history/chat-history.component.ts", "Modules/pages/chatbot/components/chat-history/chat-history.component.html", "Modules/pages/chatbot/chatbot.component.ts", "Modules/pages/chatbot/chatbot.component.html", "Modules/pages/chatbot/chatbot-routing.module.ts", "Modules/pages/chatbot/chatbot.module.ts"],
  "sourcesContent": ["import { Component, OnDestroy, ViewChild, ViewContainerRef, OnInit, Input } from '@angular/core';\nimport { GlobalService } from '../../../../core/services/global.service';\n\n@Component({\n  selector: 'app-chat',\n  templateUrl: './chat.component.html',\n  styleUrl: './chat.component.scss'\n})\nexport class ChatComponent implements OnInit, OnDestroy {\n\n  @ViewChild('container', { read: ViewContainerRef, static: true }) container!: ViewContainerRef;\n\n  @Input() pageId: string | null = null;\n\n  constructor(public globalService: GlobalService) {}\n\n  ngOnInit(): void {\n    if (this.pageId == null) {\n      this.pageId = this.globalService.logicService.getGUID();\n      this.globalService.historyService.currentChatPageId = this.pageId;\n      \n      this.globalService.liskovChatflow.layoutManager.find('chatpage')?.prepare(this.container);\n      this.globalService.chatflow.scenario('chatbot');\n    }\n    else { // history 페이지\n      this.globalService.historyService.currentChatPageId = this.pageId;\n      \n      this.globalService.dalService.chatHistoryHttp.get(this.globalService.currentUser.userData.userIdx).subscribe(response => {\n        this.globalService.historyService.allhistoryList = JSON.parse(response.data);\n        this.globalService.historyService.pageHistoryList = this.globalService.historyService.allhistoryList.find((page: any) => page.key === this.globalService.historyService.currentChatPageId);\n  \n        this.globalService.liskovChatflow.layoutManager.find('chatpage')?.prepare(this.container);\n        this.globalService.chatflow.scenario('history');\n      });\n    }\n  }\n\n  ngOnDestroy() {\n    //console.log('chatpage onDestroy');\n    this.globalService.liskovChatflow.layoutManager.find('chatpage').clear();\n  }\n\n}\n\n// constructor(public globalService: GlobalService) {\n  // this.globalService.httpService.GetJson('./assets/json/chatbot.json').subscribe(d => {\n  //   this.globalService.liskov = new LiskovModel(d, globalService);\n  //   this.globalService.behavior = new LiskovBehavior(this.globalService.liskov);\n    \n  //   this.globalService.liskov.service.chatContainer = this.container;\n  //   this.globalService.liskov.service.chatScrollBody = this.scrollBody;\n  //   this.globalService.behavior.scenario('chatbot');\n  // });\n// }\n// public selectBehavior(event: any) {\n//   if (!event.selected) {\n//     this.globalService.logicType = 'default';\n//     this.globalService.prompt = '';\n//     return;\n//   }\n//   this.globalService.logicType = event.source._value;\n//   this.globalService.prompt = '';\n// }\n\n// public getQuestion(event: KeyboardEvent | any, question: string) {\n//   if (this.globalService.socketService.isConnected) {\n//     this.globalService.httpService.Get('/grpc/llm-cancel', { 'clientid': this.globalService.socketService.id })\n//       .subscribe(d => {\n//         if (!d.message.includes('정상 종료')) return;\n//         this.globalService.socketService.isConnected = false;\n//         this.globalService.liskov.behaviorManager.find('chat')?.clear();\n//       })\n//     return;\n//   }\n\n//   if (event.isComposing) return;\n//   if (!question) return;\n//   event.preventDefault();\n\n//   this.globalService.liskov.behaviorManager.find('chat')?.prepare({\n//     message: question,\n//     component: QuestionBalloonComponent\n//   });\n//   this.globalService.liskov.behaviorManager.find('chat')?.clear();\n\n//   this.inputText.nativeElement.value = '';\n//   this.settingSimulator();\n//   this.getAnswer(question);\n// }\n\n// public getAnswer(question: string) {\n//   this.globalService.liskov.clear();\n//   this.globalService.liskov.behaviorWords.push(this.globalService.logicType);\n//   this.globalService.liskov.questionWords.push(question);\n//   this.globalService.behavior.create(); // 모든 발화는 beforhand 행동부터 시작한다.\n// }\n\n// public settingSimulator() {\n//   this.globalService.chatContainers[0] = this.container;\n//   this.globalService.chatScrollBody = this.scrollBody.nativeElement;\n// }", "<!-- <div\n  #scrollBody\n  class=\"full-balloon\"\n  style=\"background-color: white;\"\n  [style.height]=\"height\"\n>\n  <ng-container #container></ng-container>\n</div>\n<div class=\"form-full-bottom\">\n  <div class=\"form-property\">\n    <button mat-icon-button class=\"form-prompt-button\" matTooltip=\"프롬프트 라이브러리\"\n      (click)=\"this.globalService.openBottomSheet()\">\n      <mat-icon>border_color</mat-icon>\n    </button>\n    <mat-chip-listbox style=\"margin: 0 0.5rem 0 auto;\" class=\"form-ai-select-chips\">\n      <mat-chip-option (selectionChange)=\"selectBehavior($event)\" value=\"mrc\" matTooltip=\"mrc\">MRC</mat-chip-option>\n      <mat-chip-option (selectionChange)=\"selectBehavior($event)\" value=\"summary\" matTooltip=\"요약\"\n        color=\"warn\">요약</mat-chip-option>\n    </mat-chip-listbox>\n  </div>\n  <div class=\"form-input-bottom\">\n    <mat-form-field class=\"form-field\">\n      <mat-label>Question</mat-label>\n      <textarea [disabled]=\"this.globalService.socketService.isConnected\" #inputText matInput\n        placeholder=\"여기에 무엇이든 물어보세요.\" (keydown.enter)=\"getQuestion($event, inputText.value)\"></textarea>\n    </mat-form-field>\n    <button mat-icon-button class=\"form-submit-button\"\n      [matTooltip]=\"this.globalService.socketService.isConnected ? '정지' : '보내기'\"\n      (click)=\"getQuestion($event, inputText.value)\">\n      <mat-icon>{{ this.globalService.socketService.isConnected ? 'stop_circle' : 'send' }}</mat-icon>\n    </button>\n  </div>\n</div> -->\n<div style=\"width: 870px; margin: 0 auto;\">\n  <ng-container #container></ng-container>\n</div>\n", "import { Component, ElementRef, OnDestroy, OnInit, ViewChild, ViewContainerRef } from '@angular/core';\nimport { StoreAbstract } from '../../../../core/classes/store.abstract';\nimport { ListComponent } from '../../../chatflow/components/atom/list/list.component';\n\n@Component({\n  selector: 'app-chat-history',\n  templateUrl: './chat-history.component.html',\n  styleUrl: './chat-history.component.scss'\n})\nexport class ChatHistoryComponent extends StoreAbstract implements OnInit, OnDestroy {\n\n  @ViewChild('container', { read: ViewContainerRef, static: true })\n  public container!: ViewContainerRef;\n  @ViewChild('scrollBody', { read: ElementRef, static: true })\n  scrollBody!: ElementRef;\n\n  ngOnInit() {\n    this.globalService.liskovChatflow.layoutManager.find('chathistorypage')?.prepare(this.container);\n    //this.globalService.chatflow.scenario('history');\n    \n    this.dalService.chatHistoryHttp.get(this.currentUser.userData.userIdx).subscribe(response => {\n      if (response == null) return;\n      \n      this.historyService.allhistoryList = JSON.parse(response.data);\n      const groupHistoryList = this.historyService.groupHistoryList();\n      this.dynamicLayoutService.historyListContainer = this.factoryService.createComponent(\n        ListComponent,\n        this.container,\n        groupHistoryList\n      );\n      //this.dynamicLayoutService.historyListContainer.instance.scrollBody.nativeElement.scrollTop = this.dynamicLayoutService.historyListContainer.instance.scrollBody.nativeElement.scrollHeight;\n    });\n  }\n\n  ngOnDestroy() {\n    this.globalService.liskovChatflow.layoutManager.find('chathistorypage').clear();\n  }\n\n}\n", "<!-- <div>\n  <mat-accordion>\n    <ng-container #container></ng-container>\n  </mat-accordion>\n</div> -->\n<div style=\"margin: 10px;\">\n  <ng-container #scrollBody #container></ng-container>\n</div>", "import { Component, OnInit, inject } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { StoreAbstract } from '../../core/classes/store.abstract';\n\n@Component({\n  selector: 'app-chatbot',\n  templateUrl: './chatbot.component.html',\n  styleUrl: './chatbot.component.scss'\n})\nexport class ChatbotComponent extends StoreAbstract implements OnInit {\n\n  public chatPageId: string | null = null;\n\n  private route = inject(ActivatedRoute);\n\n  ngOnInit() {\n    this.OnResizeRedux();\n    this.historyService.currentChatPageId = '';\n    this.historyService.allhistoryList = null;\n    this.historyService.pageHistoryList = null;\n    this.historyService.historyMetadata = [];\n\n    this.route.paramMap.subscribe(params => {\n      this.chatPageId = params.get('chatPageId');\n    });\n  }\n\n  protected override OnResizeRedux(): void {\n    this.resize$.subscribe(d => {\n      this.layoutService.leftWidh = d.leftWidth;\n      this.layoutService.rightWidth = d.rightWidth;\n    })\n    this.resize({ leftWidth: 15, rightWidth: 85 });\n  }\n\n}\n", "<div class=\"full-layout\" [style.height]=\"layoutService.getBodyHeight()\">\n    <app-chat-history\n        class=\"history-scroll back-color\"\n        [style.width.%]=\"layoutService.leftWidh\"\n    >\n    </app-chat-history>\n    <button class=\"splitter\" [style.height]=\"layoutService.getBodyHeight()\" appSplitter></button>\n    <button\n        style=\"align-self: center; transform: translate(-15px, 0);\"\n        (click)=\"resizeButton($event)\"\n        (mouseenter)=\"layoutService.isButtonHover = true\"\n        (mouseleave)=\"layoutService.isButtonHover = false\"\n    >\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 50 50\" xmlns=\"http://www.w3.org/2000/svg\">\n            @if (layoutService.isOpen) {\n                @if (layoutService.isButtonHover) {\n                    <path d=\"M 20,25 L 28,10 M 20,25 L 28,40\" stroke=\"#9b9b9b\" stroke-width=\"7\" fill=\"none\" stroke-linecap=\"round\" />\n                } @else {\n                <line id=\"line\" x1=\"25\" y1=\"15\" x2=\"25\" y2=\"45\" fill=\"none\" stroke=\"#9b9b9b\" stroke-width=\"7\" stroke-linecap=\"round\" />\n                }\n            } @else {\n                <path d=\"M 30,25 L 22,10 M 30,25 L 22,40\" stroke=\"#9b9b9b\" stroke-width=\"7\" fill=\"none\" stroke-linecap=\"round\" />\n            }\n        </svg>\n    </button>\n    <app-chat\n        [pageId]=\"chatPageId\"\n        [style.height]=\"layoutService.getBodyHeight()\"\n        [style.width.%]=\"layoutService.rightWidth\">\n    </app-chat>\n</div>\n", "import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { ChatbotComponent } from './chatbot.component';\n\nexport const routes: Routes = [\n  {\n    path: '',\n    component: ChatbotComponent\n  },\n  {\n    path: ':chatPageId',\n    component: ChatbotComponent\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class ChatbotRoutingModule { }\n", "import { NgModule } from '@angular/core';\nimport { ChatbotComponent } from './chatbot.component';\nimport { ChatbotRoutingModule } from './chatbot-routing.module';\nimport { SharedModule } from '../../shared/shared.module';\nimport { ChatComponent } from './components/chat/chat.component';\nimport { BottomSheetComponent } from './components/bottom-sheet/bottom-sheet.component';\nimport { ChatHistoryComponent } from './components/chat-history/chat-history.component';\nimport { FileDialogComponent } from './components/file-dialog/file-dialog.component';\nimport { ChatHistoryRest } from './components/classes/chat-history.rest';\n\n@NgModule({\n  declarations: [\n    ChatbotComponent,\n    ChatComponent,\n    BottomSheetComponent,\n    ChatHistoryComponent,\n    FileDialogComponent\n  ],\n  imports: [\n    SharedModule,\n    ChatbotRoutingModule,\n  ],\n  providers: [ChatHistoryRest]\n})\nexport class ChatbotModule { }\n"],
  "mappings": "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",
  "names": []
}
